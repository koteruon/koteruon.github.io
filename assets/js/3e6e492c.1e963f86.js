"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3176],{70590:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>c,frontMatter:()=>l,metadata:()=>d,toc:()=>m});var r=i(74848),s=i(28453);const l={},t="Volume - EmptyDir",d={id:"notes/kubernetes-basics/volume-emptydir",title:"Volume - EmptyDir",description:"EmptyDir \u662f Kubernetes \u4e2d\u7684\u4e00\u7a2e\u81e8\u6642\u6027 Volume\uff0c\u4e3b\u8981\u7528\u65bc Pod \u5167\u90e8\u7684\u6578\u64da\u5b58\u5132\u3002",source:"@site/docs/notes/kubernetes-basics/17-volume-emptydir.mdx",sourceDirName:"notes/kubernetes-basics",slug:"/notes/kubernetes-basics/volume-emptydir",permalink:"/docs/notes/kubernetes-basics/volume-emptydir",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:17,frontMatter:{},sidebar:"notesSidebar",previous:{title:"Volume - Introduction",permalink:"/docs/notes/kubernetes-basics/volume-intro"},next:{title:"Volume - ConfigMap",permalink:"/docs/notes/kubernetes-basics/volume-configmap"}},o={},m=[{value:"\u5de5\u4f5c\u539f\u7406",id:"\u5de5\u4f5c\u539f\u7406",level:2},{value:"\u53ef\u8a2d\u5b9a\u7684\u53c3\u6578",id:"\u53ef\u8a2d\u5b9a\u7684\u53c3\u6578",level:2},{value:"1. <code>medium</code>",id:"1-medium",level:3},{value:"2. <code>sizeLimit</code>",id:"2-sizelimit",level:3},{value:"\u9069\u7528\u5834\u666f",id:"\u9069\u7528\u5834\u666f",level:2},{value:"\u6ce8\u610f\u4e8b\u9805",id:"\u6ce8\u610f\u4e8b\u9805",level:2},{value:"\u5be6\u4f5c\u4e00\u500b EmptyDir",id:"\u5be6\u4f5c\u4e00\u500b-emptydir",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"volume---emptydir",children:"Volume - EmptyDir"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"EmptyDir"})," \u662f Kubernetes \u4e2d\u7684\u4e00\u7a2e\u81e8\u6642\u6027 Volume\uff0c\u4e3b\u8981\u7528\u65bc Pod \u5167\u90e8\u7684\u6578\u64da\u5b58\u5132\u3002\n\u5b83\u5728 Pod \u555f\u52d5\u6642\u5275\u5efa\uff0c\u4e26\u5728 Pod \u7d42\u6b62\u5f8c\u88ab\u522a\u9664\u3002",(0,r.jsx)(n.code,{children:"EmptyDir"})," \u662f\u7c21\u55ae\u4e14\u9ad8\u6548\u7684\u6578\u64da\u5b58\u5132\u89e3\u6c7a\u65b9\u6848\uff0c\u9069\u5408\u7528\u65bc\u77ed\u671f\u5b58\u5132\u9700\u6c42\uff0c\u4f8b\u5982\u7de9\u5b58\u3001\u81e8\u6642\u6587\u4ef6\u6216\u6578\u64da\u4ea4\u63db\u3002"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5de5\u4f5c\u539f\u7406",children:"\u5de5\u4f5c\u539f\u7406"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7576 Pod \u555f\u52d5\u6642\uff0cKubernetes \u6703\u81ea\u52d5\u5728\u7bc0\u9ede\u4e0a\u5275\u5efa\u4e00\u500b\u7a7a\u7684\u76ee\u9304\uff0c\u4e26\u5c07\u5176\u639b\u8f09\u5230\u5bb9\u5668\u4e2d\u6307\u5b9a\u7684\u4f4d\u7f6e\u3002"}),"\n",(0,r.jsxs)(n.li,{children:["\u5982\u679c Pod \u91cd\u555f\uff0c",(0,r.jsx)(n.code,{children:"EmptyDir"})," \u7684\u5167\u5bb9\u4ecd\u7136\u4fdd\u7559\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:["\u7576 Pod \u88ab\u522a\u9664\u6642\uff0c",(0,r.jsx)(n.code,{children:"EmptyDir"})," \u7684\u6578\u64da\u4e5f\u6703\u4e00\u4f75\u6e05\u9664\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:["\u5982\u679c Pod \u88ab\u91cd\u65b0\u8abf\u5ea6\u5230\u5176\u4ed6\u7bc0\u9ede\uff0c",(0,r.jsx)(n.code,{children:"EmptyDir"})," \u5167\u5bb9\u4e0d\u6703\u96a8\u4e4b\u9077\u79fb\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u53ef\u8a2d\u5b9a\u7684\u53c3\u6578",children:"\u53ef\u8a2d\u5b9a\u7684\u53c3\u6578"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"EmptyDir"})," \u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u65b9\u5f0f\u9032\u884c\u914d\u7f6e\uff0c\u6eff\u8db3\u4e0d\u540c\u7684\u4f7f\u7528\u9700\u6c42\uff1a"]}),"\n",(0,r.jsxs)(n.h3,{id:"1-medium",children:["1. ",(0,r.jsx)(n.code,{children:"medium"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u7528\u65bc\u6307\u5b9a ",(0,r.jsx)(n.code,{children:"EmptyDir"})," \u7684\u5b58\u5132\u4ecb\u8cea\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u9078\u9805"}),"\uff1a","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u9ed8\u8a8d\u503c\u70ba\u7a7a\u5b57\u7b26\u4e32\uff08",(0,r.jsx)(n.code,{children:'""'}),"\uff09\uff0c\u8868\u793a\u5b58\u5132\u5728\u7bc0\u9ede\u7684\u78c1\u789f\u4e0a\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:["\u8a2d\u5b9a\u70ba ",(0,r.jsx)(n.code,{children:"Memory"})," \u6642\uff0c",(0,r.jsx)(n.code,{children:"EmptyDir"})," \u5c07\u4f7f\u7528\u7bc0\u9ede\u5167\u5b58\u4f5c\u70ba\u5b58\u5132\u4ecb\u8cea\uff08\u901a\u904e tmpfs \u5be6\u73fe\uff09\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u793a\u4f8b"}),"\uff1a","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"volumes:\n  - name: temp-storage\n    emptyDir:\n      medium: Memory\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"2-sizelimit",children:["2. ",(0,r.jsx)(n.code,{children:"sizeLimit"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u7528\u65bc\u8a2d\u7f6e ",(0,r.jsx)(n.code,{children:"EmptyDir"})," \u7684\u5927\u5c0f\u9650\u5236\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u7279\u9ede"}),"\uff1a","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u50c5\u5728 ",(0,r.jsx)(n.code,{children:"medium: Memory"})," \u6642\u6709\u6548\uff0c\u9650\u5236\u5167\u5b58\u7684\u6700\u5927\u4f7f\u7528\u91cf\u3002"]}),"\n",(0,r.jsx)(n.li,{children:"\u5982\u679c\u672a\u8a2d\u7f6e\uff0c\u5247\u4f7f\u7528\u7bc0\u9ede\u53ef\u7528\u5167\u5b58\u7684\u9ed8\u8a8d\u5206\u914d\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u793a\u4f8b"}),"\uff1a","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"volumes:\n  - name: temp-storage\n    emptyDir:\n      medium: Memory\n      sizeLimit: '256Mi'\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u9069\u7528\u5834\u666f",children:"\u9069\u7528\u5834\u666f"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u7de9\u5b58\u6578\u64da"}),"\uff1a\u4f8b\u5982\u81e8\u6642\u6578\u64da\u5b58\u5132\u548c\u8655\u7406\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5171\u4eab\u6578\u64da"}),"\uff1a\u5728\u540c\u4e00 Pod \u7684\u591a\u500b\u5bb9\u5668\u4e4b\u9593\u5171\u4eab\u6587\u4ef6\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u81e8\u6642\u6578\u64da"}),"\uff1a\u53ea\u5728 Pod \u7684\u751f\u547d\u9031\u671f\u5167\u9700\u8981\u7684\u6578\u64da\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u6ce8\u610f\u4e8b\u9805",children:"\u6ce8\u610f\u4e8b\u9805"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"EmptyDir"})," \u7684\u5167\u5bb9\u4e0d\u6703\u6301\u4e45\u5316\uff0cPod \u7d42\u6b62\u5f8c\u6240\u6709\u6578\u64da\u5c07\u4e1f\u5931\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"medium: Memory"})," \u6642\uff0c\u8acb\u6ce8\u610f\u4e0d\u8981\u8d85\u904e\u7bc0\u9ede\u5167\u5b58\u9650\u5236\uff0c\u4ee5\u514d\u5f71\u97ff\u7bc0\u9ede\u7a69\u5b9a\u6027\u3002"]}),"\n",(0,r.jsx)(n.li,{children:"\u4e0d\u9069\u5408\u7528\u65bc\u9700\u8981\u9577\u671f\u5b58\u5132\u7684\u6578\u64da\u5834\u666f\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u5be6\u4f5c\u4e00\u500b-emptydir",children:"\u5be6\u4f5c\u4e00\u500b EmptyDir"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u9996\u5148\u6211\u5011\u5efa\u7acb\u4e00\u500b pod\uff0c\u88e1\u9762\u6709\u591a\u500b container\uff0c\u5176\u4e2d\u6211\u5011\u5b9a\u7fa9 volume \u662f html\uff0c\u4e26\u4e14\u662f EmptyDir\uff0c\u5206\u5225\u639b\u8f09\u5230 nginx \u548c alpine \u9019\u5169\u500b\u5bb9\u5668\u4e2d\uff0c\nalpine \u662f\u6bcf 10 \u79d2\u6703\u5beb\u5165\u65e5\u671f\u5230 index.html\uff0cnginx \u5247\u8ca0\u8cac\u5c07\u9019\u500b index.html \u986f\u793a\u7d66\u7528\u6236\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="emptydir-pod.yaml"',children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: emptydir-pod\nspec:\n  // highlight-start\n  volumes:\n    - name: html # \u5b9a\u7fa9\u4e00\u500b\u540d\u70ba html \u7684 Volume\uff0c\u985e\u578b\u70ba EmptyDir\uff08\u672a\u6307\u5b9a medium\uff0c\u9ed8\u8a8d\u4f7f\u7528\u78c1\u789f\uff09\n      emptyDir: {}\n  // highlight-end\n  containers:\n    - name: nginx\n      image: nginx:latest\n      // highlight-start\n      volumeMounts:\n        - name: html # \u5c07\u540d\u70ba html \u7684 Volume \u639b\u8f09\u5230\u5bb9\u5668\u5167\n          mountPath: /usr/share/nginx/html # \u639b\u8f09\u8def\u5f91\u70ba nginx \u9810\u8a2d\u7684\u975c\u614b\u6587\u4ef6\u76ee\u9304\n      // highlight-end\n    - name: alpine\n      image: alpine:latest\n      // highlight-start\n      volumeMounts:\n        - name: html # \u540c\u6a23\u5c07\u540d\u70ba html \u7684 Volume \u639b\u8f09\u5230\u5bb9\u5668\u5167\n          mountPath: /html # \u639b\u8f09\u8def\u5f91\u70ba /html\n      // highlight-end\n      command: ['/bin/sh', '-c']\n      args:\n        - while true; do\n          echo $(hostname) $(date) >> /html/index.html;\n          sleep 10;\n          done\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"\u5efa\u7acb\u9019\u500b Pod\uff0c\u4e26\u4e14\u67e5\u770b\u9019\u500b Pod \u7684\u72c0\u614b\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl.exe apply -f emptydir-pod.yaml\n---\n\npod/emptydir-pod created\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"kubectl.exe describe pods/emptydir-pod\n---\n\nName:             emptydir-pod\n...\u4e2d\u9593\u7701\u7565...\nContainers:\n  nginx:\n    ...\u4e2d\u9593\u7701\u7565...\n    Mounts:\n      // highlight-next-line\n      /usr/share/nginx/html from html (rw)\n      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-hwnlw (ro)\n  alpine:\n    ...\u4e2d\u9593\u7701\u7565...\n    Mounts:\n      // highlight-next-line\n      /html from html (rw)\n      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-hwnlw (ro)\n...\u4e2d\u9593\u7701\u7565...\n// highlight-start\nVolumes:\n  html:\n    Type:       EmptyDir (a temporary directory that shares a pod's lifetime)\n    Medium:\n    SizeLimit:  <unset>\n// highlight-end\n...\u5f8c\u9762\u7701\u7565...\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"\u63a5\u8457\u6211\u5011\u900f\u904e port-forwart \u4f86\u8a2a\u554f\u9019\u500b Pod\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl.exe port-forward pods/emptydir-pod 8080:80\n---\n\nForwarding from 127.0.0.1:8080 -> 80\nForwarding from [::1]:8080 -> 80\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"\u900f\u904e\u8a2a\u554f\u9019\u500b Pod\uff0c\u6211\u5011\u53ef\u4ee5\u770b\u6bcf\u9694 10 \u79d2\u9418\u5c31\u6709\u4e00\u7b46\u6578\u64da\u88ab\u8a18\u9304\uff0c\u4e26\u4e14 alpine \u548c nginx \u9019\u5169\u500b container \u5171\u7528\u4e00\u500b volume\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"(Invoke-WebRequest -Uri http://localhost:8080 -UseBasicParsing).Content\n---\n\nemptydir-pod Thu Jan 23 08:40:51 UTC 2025\nemptydir-pod Thu Jan 23 08:41:01 UTC 2025\nemptydir-pod Thu Jan 23 08:41:11 UTC 2025\nemptydir-pod Thu Jan 23 08:41:21 UTC 2025\nemptydir-pod Thu Jan 23 08:41:31 UTC 2025\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"\u76f8\u540c\u6211\u5011\u4e5f\u53ef\u4ee5\u900f\u904e memory \u7684\u65b9\u5f0f\uff0c\u5728\u5b9a\u7fa9 medium \u7684\u5730\u65b9\u8a2d\u5b9a\u70ba Memory\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="emptydir-memory-pod.yaml"',children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: emptydir-memory-pod\nspec:\n  volumes:\n    - name: html\n      emptyDir:\n        // highlight-next-line\n        medium: Memory\n        sizeLimit: 256Mi\n  containers:\n    - name: nginx\n      image: nginx:latest\n      volumeMounts:\n        - name: html\n          mountPath: /usr/share/nginx/html\n    - name: alpine\n      image: alpine:latest\n      volumeMounts:\n        - name: html\n          mountPath: /html\n      command: ['/bin/sh', '-c']\n      args:\n        - while true; do\n          echo $(hostname) $(date) >> /html/index.html;\n          sleep 10;\n          done\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"7",children:["\n",(0,r.jsx)(n.li,{children:"\u4f9d\u7167\u4e0a\u9762\u7684\u65b9\u5f0f\u57f7\u884c\u4ed6\uff0c\u4e26\u4e14\u4f7f\u7528port-forward\u5f8c\uff0c\u76f4\u63a5\u547c\u53ebPod\uff0c\u53ef\u4ee5\u770b\u5230\u4e00\u6a23\u6bcf10\u79d2\u8f38\u51fa\u4e00\u6b21\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl.exe apply -f emptydir-memory-pod.yaml\n---\n\npod/emptydir-memory-pod created\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl.exe port-forward pods/emptydir-memory-pod 8080:80\n---\n\nForwarding from 127.0.0.1:8080 -> 80\nForwarding from [::1]:8080 -> 80\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(Invoke-WebRequest -Uri http://localhost:8080 -UseBasicParsing).Content\n---\n\nemptydir-memory-pod Thu Jan 23 08:46:54 UTC 2025\nemptydir-memory-pod Thu Jan 23 08:47:04 UTC 2025\nemptydir-memory-pod Thu Jan 23 08:47:14 UTC 2025\nemptydir-memory-pod Thu Jan 23 08:47:24 UTC 2025\nemptydir-memory-pod Thu Jan 23 08:47:34 UTC 2025\n"})})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>d});var r=i(96540);const s={},l=r.createContext(s);function t(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);