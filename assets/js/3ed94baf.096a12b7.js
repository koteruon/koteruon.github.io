"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[9825],{2260:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>c,frontMatter:()=>t,metadata:()=>a,toc:()=>s});var o=r(4848),i=r(8453);const t={},l="Command Pattern (\u547d\u4ee4\u6a21\u5f0f) (Action) (Transaction)",a={id:"notes/design-patterns/Command-Pattern",title:"Command Pattern (\u547d\u4ee4\u6a21\u5f0f) (Action) (Transaction)",description:"\u547d\u4ee4\u6a21\u5f0f\u662f\u4e00\u7a2e\u884c\u70ba\u8a2d\u8a08\u6a21\u5f0f\uff0c\u53ef\u5c07\u8acb\u6c42\u5c01\u88dd\u6210\u7269\u4ef6\uff0c\u8b93\u4f60\u53ef\u4ee5\u5c07\u8acb\u6c42\u3001\u4f47\u5217\u6216\u7d00\u9304\u7b49\u7269\u4ef6\u53c3\u6578\u5316\uff0c\u4e26\u652f\u63f4\u53ef\u5fa9\u539f\u7684\u7684\u64cd\u4f5c",source:"@site/docs/notes/design-patterns/Command-Pattern.md",sourceDirName:"notes/design-patterns",slug:"/notes/design-patterns/Command-Pattern",permalink:"/docs/notes/design-patterns/Command-Pattern",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/notes/design-patterns/Command-Pattern.md",tags:[],version:"current",frontMatter:{},sidebar:"notesSidebar",previous:{title:"Adapter Pattern (\u8f49\u63a5\u5668\u6a21\u5f0f)",permalink:"/docs/notes/design-patterns/Adapter-Pattern"},next:{title:"Decorator Pattern (\u88dd\u98fe\u5668\u6a21\u5f0f)",permalink:"/docs/notes/design-patterns/Decorator-Pattern"}},d={},s=[{value:"\u547d\u4ee4\u6a21\u5f0f\u7d50\u69cb",id:"\u547d\u4ee4\u6a21\u5f0f\u7d50\u69cb",level:3},{value:"\u547d\u4ee4\u6a21\u5f0f\u7684\u61c9\u7528\u5834\u666f",id:"\u547d\u4ee4\u6a21\u5f0f\u7684\u61c9\u7528\u5834\u666f",level:3},{value:"\u4f7f\u7528\u6642\u6a5f",id:"\u4f7f\u7528\u6642\u6a5f",level:3},{value:"\u512a\u7f3a\u9ede",id:"\u512a\u7f3a\u9ede",level:3},{value:"\u547d\u4ee4\u6a21\u5f0f(Command Pattern)",id:"\u547d\u4ee4\u6a21\u5f0fcommand-pattern",level:2},{value:"\u9047\u5230\u7684\u9700\u6c42",id:"\u9047\u5230\u7684\u9700\u6c42",level:3},{value:"\u9047\u5230\u7684\u554f\u984c",id:"\u9047\u5230\u7684\u554f\u984c",level:3},{value:"\u547d\u4ee4\u7269\u4ef6",id:"\u547d\u4ee4\u7269\u4ef6",level:3},{value:"\u5b8c\u6574\u7684\u9059\u63a7\u5668\u88fd\u4f5c",id:"\u5b8c\u6574\u7684\u9059\u63a7\u5668\u88fd\u4f5c",level:3},{value:"\u6587\u4ef6\u64b0\u5beb",id:"\u6587\u4ef6\u64b0\u5beb",level:3},{value:"\u4f7f\u7528 lambda \u512a\u5316",id:"\u4f7f\u7528-lambda-\u512a\u5316",level:3},{value:"\u5fa9\u539f\u6309\u9215",id:"\u5fa9\u539f\u6309\u9215",level:2},{value:"\u96fb\u71c8\u958b\u95dc\u6062\u5fa9",id:"\u96fb\u71c8\u958b\u95dc\u6062\u5fa9",level:3},{value:"\u4f7f\u7528\u72c0\u614b\u4f86\u5be6\u4f5c\u6062\u5fa9",id:"\u4f7f\u7528\u72c0\u614b\u4f86\u5be6\u4f5c\u6062\u5fa9",level:3},{value:"\u6b77\u53f2\u7d00\u9304\u7684\u65b9\u6cd5",id:"\u6b77\u53f2\u7d00\u9304\u7684\u65b9\u6cd5",level:3},{value:"\u4f7f\u7528\u5de8\u96c6 Command(\u6d3e\u5c0d\u6a21\u5f0f)",id:"\u4f7f\u7528\u5de8\u96c6-command\u6d3e\u5c0d\u6a21\u5f0f",level:2},{value:"\u9700\u6c42",id:"\u9700\u6c42",level:3},{value:"\u5275\u5efa\u5de8\u96c6\u7684 Command",id:"\u5275\u5efa\u5de8\u96c6\u7684-command",level:3},{value:"\u6c92\u6709\u8822\u554f\u984c",id:"\u6c92\u6709\u8822\u554f\u984c",level:2},{value:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014: \u5c07\u8acb\u6c42\u4f47\u5217\u5316(ThreadPoolExecutor)",id:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014-\u5c07\u8acb\u6c42\u4f47\u5217\u5316threadpoolexecutor",level:2},{value:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014: \u8a18\u9304\u8acb\u6c42",id:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014-\u8a18\u9304\u8acb\u6c42",level:2},{value:"\u6bd4\u8f03\u5e38\u898b\u7684\u505a\u6cd5\u662f\uff0c\u4f7f\u7528\u4e00\u500b\u65b0\u7684\u4ecb\u9762",id:"\u6bd4\u8f03\u5e38\u898b\u7684\u505a\u6cd5\u662f\u4f7f\u7528\u4e00\u500b\u65b0\u7684\u4ecb\u9762",level:3},{value:"\u5132\u5b58\u7684\u5be6\u73fe",id:"\u5132\u5b58\u7684\u5be6\u73fe",level:3},{value:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014: \u89c0\u5bdf\u8005\u6a21\u5f0f\u517c\u547d\u4ee4\u6a21\u5f0f",id:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014-\u89c0\u5bdf\u8005\u6a21\u5f0f\u517c\u547d\u4ee4\u6a21\u5f0f",level:2},{value:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62: \u5c01\u88dd\u63a5\u6536\u8005 (Encapsulate Receiver)",id:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62-\u5c01\u88dd\u63a5\u6536\u8005-encapsulate-receiver",level:2},{value:"\u5931\u6557\u7684\u8a2d\u8a08",id:"\u5931\u6557\u7684\u8a2d\u8a08",level:3},{value:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62: \u5ba2\u6236\u7aef \u2014 \u8077\u8cac\u5206\u96e2 (Client \u2014 Segregation of Duties)",id:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62-\u5ba2\u6236\u7aef--\u8077\u8cac\u5206\u96e2-client--segregation-of-duties",level:2},{value:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62: \u667a\u6167\u547d\u4ee4",id:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62-\u667a\u6167\u547d\u4ee4",level:2}];function m(n){const e={admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"command-pattern-\u547d\u4ee4\u6a21\u5f0f-action-transaction",children:"Command Pattern (\u547d\u4ee4\u6a21\u5f0f) (Action) (Transaction)"})}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"\u547d\u4ee4\u6a21\u5f0f"}),"\u662f\u4e00\u7a2e\u884c\u70ba\u8a2d\u8a08\u6a21\u5f0f\uff0c\u53ef\u5c07\u8acb\u6c42\u5c01\u88dd\u6210\u7269\u4ef6\uff0c\u8b93\u4f60\u53ef\u4ee5\u5c07\u8acb\u6c42\u3001\u4f47\u5217\u6216\u7d00\u9304\u7b49\u7269\u4ef6\u53c3\u6578\u5316\uff0c\u4e26\u652f\u63f4\u53ef\u5fa9\u539f\u7684\u7684\u64cd\u4f5c"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"\u547d\u4ee4\u6a21\u5f0f\u7d50\u69cb",children:"\u547d\u4ee4\u6a21\u5f0f\u7d50\u69cb"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"\u547d\u4ee4\u6a21\u5f0f\u7d50\u69cb",src:r(6973).A+"",width:"2133",height:"2133"})}),"\n",(0,o.jsx)(e.h3,{id:"\u547d\u4ee4\u6a21\u5f0f\u7684\u61c9\u7528\u5834\u666f",children:"\u547d\u4ee4\u6a21\u5f0f\u7684\u61c9\u7528\u5834\u666f"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"\u5982\u679c\u9700\u8981\u628a\u52d5\u4f5c\u8b8a\u6210\u53c3\u6578\u5316\u5c0d\u8c61"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\u547d\u4ee4\u6a21\u5f0f\u53ef\u5c07\u7279\u5b9a\u7684\u65b9\u6cd5\u8f49\u5316\u6210\u7368\u7acb\u5c0d\u8c61\u3002\u4f60\u53ef\u4ee5\u5c07\u547d\u4ee4\u4f5c\u70ba\u65b9\u6cd5\u7684\u53c3\u6578\u9032\u884c\u50b3\u905e\uff0c\u5c07\u547d\u4ee4\u4fdd\u5b58\u5728\u5176\u4ed6\u5c0d\u8c61\u4e2d\uff0c\u6216\u662f\u5728\u57f7\u884c\u671f\u5207\u63db\u5df2\u9023\u63a5\u7684\u547d\u4ee4\u3002"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"\u5982\u679c\u60f3\u8981\u5c07\u52d5\u4f5c\u653e\u5165\u968a\u5217\u4e2d\u3001\u52d5\u4f5c\u7684\u57f7\u884c\u6216\u9060\u7a0b\u57f7\u884c\u52d5\u4f5c"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\u540c\u5176\u4ed6\u5c0d\u8c61\u4e00\u6a23\uff0c\u547d\u4ee4\u4e5f\u53ef\u4ee5\u5be6\u73fe\u5e8f\u5217\u5316\uff0c\u5f9e\u800c\u65b9\u4fbf\u7684\u5beb\u5165\u6587\u4ef6\u6216\u6578\u64da\u5eab\u4e2d\u3002\u4e00\u6bb5\u6642\u9593\u5f8c\uff0c\u518d\u5c07\u4ed6\u6062\u5fa9\u6210\u6700\u521d\u7684\u547d\u4ee4\u5c0d\u8c61\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u5ef6\u9072\u6216\u8a08\u5283\u547d\u4ee4\u7684\u57f7\u884c\u3002\u4e5f\u53ef\u4ee5\u5c07\u547d\u4ee4\u653e\u5165\u968a\u5217\u3001\u7d00\u9304\u547d\u4ee4\u3001\u901a\u904e\u7db2\u8def\u50b3\u9001\u547d\u4ee4\u3002"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"\u5982\u679c\u4f60\u60f3\u8981\u5be6\u73fe\u64cd\u4f5c\u56de\u6efe\u529f\u80fd"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\u76e1\u7ba1\u6709\u5f88\u591a\u65b9\u6cd5\u53ef\u4ee5\u5be6\u73fe\u64a4\u92b7\u548c\u6062\u5fa9\u529f\u80fd\uff0c\u4f46\u547d\u4ee4\u6a21\u5f0f\u662f\u5176\u4e2d\u5e38\u7528\u7684\u4e00\u7a2e\u3002\r\n\u70ba\u4e86\u80fd\u5920\u56de\u6efe\u64cd\u4f5c\uff0c\u4f60\u9700\u8981\u5be6\u73fe\u5df2\u57f7\u884c\u64cd\u4f5c\u7684\u6b77\u53f2\u7d00\u9304\u529f\u80fd\u3002\u5c0d\u6240\u6709\u5df2\u57f7\u884c\u547d\u4ee4\u5c0d\u8c61\u53ca\u5176\u76f8\u95dc\u7a0b\u5e8f\u72c0\u614b\u5099\u4efd\u7684 stack \u7d50\u69cb\uff0c\u4f46\u662f\u9019\u7a2e\u65b9\u6cd5\u6709\u5169\u500b\u7f3a\u9ede\u3002"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["\u7a0b\u5f0f\u72c0\u614b\u7684\u4fdd\u5b58\u529f\u80fd\u4e26\u4e0d\u5bb9\u6613\u5be6\u73fe\uff0c\u56e0\u70ba\u90e8\u5206\u72c0\u614b\u70ba\u79c1\u6709\u3002\u53ef\u4ee5\u4f7f\u7528",(0,o.jsx)(e.strong,{children:"\u5099\u5fd8\u9304\u6a21\u5f0f"}),"\u4f86\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u89e3\u6c7a\u9019\u500b\u554f\u984c\u3002"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"\u5099\u4efd\u72c0\u614b\u53ef\u80fd\u6703\u5360\u7528\u5927\u91cf\u5167\u5b58\u3002\u6709\u6642\u9700\u8981\u501f\u52a9\u53e6\u4e00\u7a2e\u5be6\u73fe\u65b9\u5f0f\uff1a\u53cd\u5411\u64cd\u4f5c\u3002\u53cd\u5411\u64cd\u4f5c\u4e5f\u6709\u4ee3\u50f9\uff1a\u4ed6\u53ef\u80fd\u6703\u5f88\u96e3\u751a\u81f3\u7121\u6cd5\u5be6\u73fe\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"\u4f7f\u7528\u6642\u6a5f",children:"\u4f7f\u7528\u6642\u6a5f"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["\u60f3",(0,o.jsx)(e.em,{children:"\u53c3\u6578\u5316"}),"\u8acb\u6c42\u300e\u6b32\u57f7\u884c\u7684\u4efb\u52d9\u300f\u6642"]}),"\n",(0,o.jsxs)(e.li,{children:["\u4f9d\u4e0d\u540c",(0,o.jsx)(e.em,{children:"\u6642\u9593"}),"\u6216",(0,o.jsx)(e.em,{children:"\u4f47\u5217"}),"\u57f7\u884c\u547d\u4ee4\u6642"]}),"\n",(0,o.jsxs)(e.li,{children:["\u767c\u9001",(0,o.jsx)(e.em,{children:"\u8a0a\u606f\u8005"}),"\u8207",(0,o.jsx)(e.em,{children:"\u63a5\u6536\u57f7\u884c\u8005"}),"\u7684\u751f\u547d\u9031\u671f\u4e0d\u540c\u6642"]}),"\n",(0,o.jsxs)(e.li,{children:["\u8b93\u57f7\u884c\u7684\u4efb\u52d9\u5177\u6709",(0,o.jsx)(e.em,{children:"\u5fa9\u539f"}),"\u6216",(0,o.jsx)(e.em,{children:"\u65e5\u8a8c"}),"\u529f\u80fd\u6642"]}),"\n",(0,o.jsxs)(e.li,{children:["\u5be6\u4f5c",(0,o.jsx)(e.em,{children:"\u4ea4\u6613(Transaction)\u529f\u80fd"}),"\u6642"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"\u512a\u7f3a\u9ede",children:"\u512a\u7f3a\u9ede"}),"\n",(0,o.jsxs)(e.p,{children:["\u2b55",(0,o.jsx)(e.strong,{children:"\u512a\u9ede"})]}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u55ae\u4e00\u8077\u8cac\u539f\u5247\u3002\u53ef\u4ee5\u89e3\u85d5\u89f8\u767c\u548c\u57f7\u884c\u64cd\u4f5c\u7684\u985e\u3002"}),"\n",(0,o.jsx)(e.li,{children:"\u958b\u653e\u5c01\u9589\u539f\u5247\u3002\u53ef\u4ee5\u5728\u4e0d\u4fee\u6539\u5df2\u6709\u5ba2\u6236\u7aef\u7a0b\u5f0f\u78bc\u7684\u60c5\u6cc1\u4e0b\uff0c\u5728\u7a0b\u5f0f\u78bc\u4e2d\u5275\u5efa\u5148\u7684\u547d\u4ee4\u3002"}),"\n",(0,o.jsx)(e.li,{children:"\u53ef\u4ee5\u5be6\u73fe\u64a4\u92b7\u548c\u6062\u5fa9\u529f\u80fd(Undoable Operations)"}),"\n",(0,o.jsx)(e.li,{children:"\u53ef\u4ee5\u5be6\u73fe\u64cd\u4f5c\u7684\u5ef6\u9072\u57f7\u884c(Temporal Decoupling)"}),"\n",(0,o.jsx)(e.li,{children:"\u53ef\u4ee5\u5c07\u4e00\u7d44\u7c21\u55ae\u547d\u4ee4\u7d44\u5408\u6210\u4e00\u500b\u8907\u96dc\u547d\u4ee4"}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["\u274c",(0,o.jsx)(e.strong,{children:"\u7f3a\u9ede"})]}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u7a0b\u5f0f\u78bc\u6703\u8b8a\u5f97\u66f4\u52a0\u8907\u96dc\uff0c\u56e0\u70ba\u4f60\u5728\u767c\u9001\u8005\u548c\u63a5\u6536\u8005\u4e4b\u9593\u589e\u52a0\u4e86\u4e00\u500b\u5168\u65b0\u7684\u5c64\u6b21\u3002"}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"\u547d\u4ee4\u6a21\u5f0fcommand-pattern",children:"\u547d\u4ee4\u6a21\u5f0f(Command Pattern)"}),"\n",(0,o.jsxs)(e.p,{children:["command \u7269\u4ef6\u85c9\u8457\u5c07\u6e96\u5099\u9001\u7d66 receiver \u7684\u4e00\u7d44\u884c\u52d5\u7d81\u5728\u4e00\u8d77\uff0c\u4f86",(0,o.jsx)(e.strong,{children:"\u5c01\u88dd"}),"\u8acb\u6c42\u3002command \u7269\u4ef6\u5c07\u52d5\u4f5c\u548c receiver \u90fd\u5305\u5728\u5b83\u88e1\u9762\uff0c\u53ea\u516c\u958b\u4e00\u500b\u65b9\u6cd5 excute()\u3002\u7576\u4f60\u547c\u53eb execute()\u6642\uff0c\u5c31\u6703\u547c\u53eb receiver \u7684\u52d5\u4f5c\u3002\u5728\u5916\u9762\uff0c\u5176\u4ed6\u7684\u7269\u4ef6\u90fd\u4e0d\u77e5\u9053\u54ea\u500b receiver \u57f7\u884c\u4ec0\u9ebc\u52d5\u4f5c\uff0c\u4ed6\u5011\u53ea\u77e5\u9053\u547c\u53eb execute()\u65b9\u6cd5\u4e4b\u5f8c\uff0c\u4ed6\u5011\u7684\u8acb\u6c42\u5c31\u6703\u88ab\u8655\u7406\u3002"]}),"\n",(0,o.jsxs)(e.admonition,{type:"tip",children:[(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"\u547d\u4ee4\u6a21\u5f0f"}),"\u53ef\u5c07\u8acb\u6c42\u5c01\u88dd\u6210\u7269\u4ef6\uff0c\u8b93\u4f60\u53ef\u4ee5\u5c07\u8acb\u6c42\u3001\u4f47\u5217\u6216\u7d00\u9304\u7b49\u7269\u4ef6\u53c3\u6578\u5316\uff0c\u4e26\u652f\u63f4\u53ef\u5fa9\u539f\u7684\u7684\u64cd\u4f5c\u3002"]}),(0,o.jsxs)(e.p,{children:["\u5c07\u300e",(0,o.jsx)(e.strong,{children:"\u5f15\u767c\u547d\u4ee4\u7684\u7269\u4ef6"}),"\u300f\u8207\u300e",(0,o.jsx)(e.strong,{children:"\u5be6\u969b\u57f7\u884c\u64cd\u4f5c\u7684\u7269\u4ef6"}),"\u300f\u9694\u96e2\u958b\u4f86"]})]}),"\n",(0,o.jsx)(e.h3,{id:"\u9047\u5230\u7684\u9700\u6c42",children:"\u9047\u5230\u7684\u9700\u6c42"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u6211\u5011\u60f3\u8981\u8a2d\u8a08\u4e00\u500b\u63a7\u5236\u5668\uff0c\u4e0a\u9762\u53ef\u4ee5\u767b\u5165\u5f88\u591a\u8a2d\u5099\uff0c\u53e6\u5916\u6709 ON \u548c OFF \u7684\u6309\u9215\u4f86\u63a7\u5236\u8a2d\u5099\uff0c\u4ee5\u53ca\u6700\u5f8c\u4e00\u500b UNDO \u53ef\u4ee5\u5fa9\u539f\u7684\u6309\u9215"}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"\u63a7\u5236\u5668",src:r(2870).A+"",width:"1146",height:"2109"})}),"\n",(0,o.jsx)(e.h3,{id:"\u9047\u5230\u7684\u554f\u984c",children:"\u9047\u5230\u7684\u554f\u984c"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u5ee0\u5546\u7684\u985e\u5225\u6709\u975e\u5e38\u591a\uff0c\u800c\u4e14\u6709\u8457\u5f88\u4e0d\u4e00\u6a23\u7684\u4ecb\u9762\uff0c\u56e0\u6b64\u5e0c\u671b\u9059\u63a7\u5668\u4e0d\u9700\u8981\u77e5\u9053\u592a\u591a\u5bb6\u96fb\u7684\u4ecb\u9762\u7d30\u7bc0\uff0c\u4e5f\u4e0d\u60f3\u5728\u9059\u63a7\u5668\u88e1\u9762\u6709\u4e00\u5806\u5bb6\u96fb\u7684 if\uff0c(\u5982\uff1a if slot1 == Light, then light.on())"}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"\u5ee0\u5546\u7684\u985e\u5225",src:r(8870).A+"",width:"2433",height:"1983"})}),"\n",(0,o.jsx)(e.h3,{id:"\u547d\u4ee4\u7269\u4ef6",children:"\u547d\u4ee4\u7269\u4ef6"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u547d\u4ee4\u7269\u4ef6\u53ef\u4ee5\u7528\u7279\u5b9a\u7684\u7269\u4ef6(\u4f8b\u5982\u5ba2\u5ef3\u96fb\u71c8\u7269\u4ef6)\u4f86\u5c01\u88dd\u505a\u67d0\u4ef6\u4e8b\u60c5\u7684\u8acb\u6c42(\u4f8b\u5982\u6253\u958b\u96fb\u71c8)"}),"\n",(0,o.jsx)(e.li,{children:"\u6211\u5011\u5e6b\u9059\u63a7\u5668\u7684\u6309\u9215\u6307\u5b9a\u4e00\u500b\u547d\u4ee4\u7269\u4ef6\uff0c\u6309\u4e0b\u6309\u9215\u6642\uff0c\u53ea\u9700\u8981\u547c\u53eb\u547d\u4ee4\u7269\u4ef6\u505a\u67d0\u9805\u5de5\u4f5c\u5373\u53ef"}),"\n"]}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u5be6\u4f5c Command \u4ecb\u9762\uff0c\u6240\u6709\u7684 Command \u7269\u4ef6\u90fd\u5be6\u4f5c\u540c\u4e00\u500b\u4ecb\u9762\uff0c\u4ecb\u9762\u6709\u4e00\u500b\u901a\u7528\u65b9\u6cd5(execute)"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public interface Command {\r\n    public void execute(); // \u53ea\u9700\u8981\u4e00\u500bexecute\u65b9\u6cd5\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"2",children:["\n",(0,o.jsx)(e.li,{children:"\u5be6\u4f5c\u4e00\u500b Command \u4f86\u958b\u71c8\u3002(\u6216\u662f\u8aaa\u5c07\u5ee0\u5546\u7684\u7269\u4ef6\u5c01\u88dd\u5728 Command \u4ecb\u9762\u4e2d)"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public class LightOnCommand implements Command { // \u6211\u5011\u8981\u5be6\u4f5cCommand\u4ecb\u9762\r\n    Light light; // \u5bb6\u96fb\u7684\u7269\u4ef6\r\n\r\n    public LightOnCommand(Light light) { // \u8b93\u5efa\u69cb\u5f0f\u63a5\u6536\u9019\u500bcommand\u8981\u63a7\u5236\u7684\u96fb\u71c8\uff0c\u5047\u8a2d\u662f\u5ba2\u5ef3\u96fb\u71c8\uff0c\u4e26\u5c07\u5b83\u5b58\u5165\u8b8a\u6578\u4e2d\u3002\u7576execute\u88ab\u547c\u53eb\u7684\u6642\u5019\uff0c\u63a5\u6536\u8acb\u6c42\u7684\u5c31\u662f\u9019\u500b\u7269\u4ef6\u3002\r\n        this.light = light;\r\n    }\r\n\r\n    public void execute() { // execute()\u65b9\u6cd5\u547c\u53eb\u7269\u4ef6\u7684on()\u65b9\u6cd5\r\n        light.on();\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"3",children:["\n",(0,o.jsx)(e.li,{children:"\u5efa\u7acb Invoker\uff0c\u4f7f\u7528 command \u7269\u4ef6\u3002\u5047\u8a2d\u6211\u5011\u7684\u9059\u63a7\u5668\u53ea\u6709\u4e00\u500b\u6309\u9215\u53ca\u5176\u5c0d\u61c9\u7684\u4f4d\u7f6e"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"// This is the invoker\r\npublic class SimpleRemoteControl {\r\n    Command slot;\r\n\r\n    public SimpleRemoteControl() {}\r\n\r\n    public void setCommand(Command command) {\r\n        slot = command;\r\n    }\r\n\r\n    public void buttonWasPressed() {\r\n        slot.execute();\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"4",children:["\n",(0,o.jsx)(e.li,{children:"\u5efa\u7acb\u7c21\u55ae\u7684\u6e2c\u8a66\u7a0b\u5f0f\u4f86\u4f7f\u7528\u9059\u63a7\u5668"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public class RemoteControlTest { // \u9019\u662f\u547d\u4ee4\u6a21\u5f0f\u4e2d\u7684client\r\n    public static void main(String[] args) {\r\n        SimpleRemoteControl remote = new SimpleRemoteControl(); // \u9059\u63a7\u5668\u662f\u4e00\u500binvoker\uff0c\u5b83\u6703\u6536\u5230\u4e00\u500bcommand\u7269\u4ef6\uff0c\u90a3\u500bcommand\u7269\u4ef6\u53ef\u4ee5\u7528\u4f86\u767c\u51fa\u8acb\u6c42\r\n        Light light = new Light(); // \u5efa\u7acbLight\u7269\u4ef6\uff0c\u5b83\u662f\u63a5\u53d7\u8acb\u6c42\u7684Receiver\r\n        LightOnCommand lightOn = new LightOnCommand(light); // \u5728\u9019\u88e1\u5efa\u7acb\u4e00\u500bcommand\uff0c\u4e26\u5c07Receiver\u50b3\u7d66\u4ed6\r\n\r\n        remote.setCommand(lightOn); // \u5c07commnad\u50b3\u7d66Invoker\r\n        remote.buttonWasPressed(); // \u6a21\u64ec\u6309\u9215\u88ab\u6309\u4e0b\r\n    }\r\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u5b8c\u6574\u7684\u9059\u63a7\u5668\u88fd\u4f5c",children:"\u5b8c\u6574\u7684\u9059\u63a7\u5668\u88fd\u4f5c"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u518d\u9059\u63a7\u5668\u4e2d\u6709\u4e03\u500b\u4f4d\u7f6e\uff0c\u6bcf\u4e00\u500b\u4f4d\u7f6e\u90fd\u6709\u958b\u3001\u95dc\u6309\u9215\uff0c\u53ef\u4ee5\u5c07 command \u6307\u6d3e\u7d66\u9059\u63a7\u5668"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"onCommands[0] = onCommand;\r\noffCommands[0] = offCommand;\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"2",children:["\n",(0,o.jsxs)(e.li,{children:["\u7576\u6211\u5011\u5efa\u7acb\u5c07\u88ab\u8f09\u5165\u9059\u63a7\u5668\u7684 Command \u6642\uff0c\u6211\u5011\u6703\u5efa\u7acb",(0,o.jsx)(e.em,{children:"\u4e00\u500b\u5ba2\u5ef3\u96fb\u71c8\u7269\u4ef6\u7684 LightCommand"}),"\uff0c\u53e6\u5916\u5efa\u7acb",(0,o.jsx)(e.em,{children:"\u4e00\u500b\u5eda\u623f\u96fb\u71c8\u7269\u4ef6\u7684 LightCommand"}),"\u3002\u56e0\u6b64",(0,o.jsx)(e.strong,{children:"\u8acb\u6c42\u7684 receiver \u8207\u5c01\u88dd\u5b83\u7684 command \u662f\u7d81\u5b9a\u7684"}),"\u3002\u6240\u4ee5\uff0c\u7576\u6309\u9215\u88ab\u6309\u4e0b\u6642\uff0c",(0,o.jsx)(e.strong,{children:"\u6c92\u6709\u4eba\u5728\u4e4e\u96fb\u71c8\u662f\u54ea\u4e00\u500b"}),"\uff0c\u7576 execute()\u65b9\u6cd5\u88ab\u547c\u53eb\u6642\uff0c\u5c0d\u7684\u4e8b\u60c5\u5c31\u6703\u767c\u751f\u3002"]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'Light light = new Light("Living Room"); // \u5ba2\u5ef3\u96fb\u71c8\u7684\u7269\u4ef6\r\nLightOnCommand lightOn = new LightOnCommand(light); // \u5ba2\u5ef3\u96fb\u71c8\u7684\u547d\u4ee4\r\nLight light = new Light("Kitchen"); // \u5eda\u623f\u96fb\u71c8\u7684\u7269\u4ef6\r\nLightOnCommand lightOn = new LightOnCommand(light); // \u5eda\u623f\u96fb\u71c8\u7684\u547d\u4ee4\n'})}),"\n",(0,o.jsxs)(e.ol,{start:"3",children:["\n",(0,o.jsx)(e.li,{children:"\u5c07 Command \u6307\u6d3e\u7d66\u4f4d\u7f6e"}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"\u5b8c\u6210\u7684\u63a7\u5236\u5668",src:r(1774).A+"",width:"1146",height:"2109"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'// This is the invoker\r\npublic class RemoteControl { // \u9019\u4e00\u6b21\u63a7\u5236\u5668\u6703\u8655\u74067\u500bOn\u548cOff command\uff0c\u6211\u5011\u5c07\u7528\u76f8\u61c9\u7684\u9663\u5217\u4f86\u4fdd\u5b58\u4ed6\u5011\r\n    Command[] onCommands;\r\n    Command[] offCommands;\r\n\r\n    public RemoteControl() { // \u5efa\u69cb\u5f0f\u88e1\uff0c\u6211\u5011\u53ea\u9700\u8981\u5be6\u4f8b\u5316\u8207\u521d\u59cb\u5316On \u548c Off \u9663\u5217\u5373\u53ef\u3002\r\n        onCommands = new Command[7];\r\n        offCommands = new Command[7];\r\n\r\n        Command noCommand = new NoCommand();\r\n        for (int i = 0; i < 7; i++) {\r\n            onCommands[i] = noCommand;\r\n            offCommands[i] = noCommand;\r\n        }\r\n    }\r\n\r\n    public void setCommand(int slot, Command onCommand, Command offCommand) { // \u63a5\u6536\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u8981\u5b58\u5165\u90a3\u500b\u4f4d\u7f6e\u7684 On \u548c Off command\r\n        onCommands[slot] = onCommand; // \u5c07\u9019\u4e9bcommand\u653e\u5165On\u8207Off\u9663\u5217\uff0c\u4ee5\u5099\u5f8c\u7528\r\n        offCommands[slot] = offCommand;\r\n    }\r\n\r\n    public void onButtonWasPushed(int slot) { // \u7576On \u6216 Off \u6309\u9215\u88ab\u6309\u4e0b\u6642\uff0c\u7531\u786c\u9ad4\u8ca0\u8cac\u547c\u53eb\u5c0d\u61c9\u7684\u65b9\u6cd5\r\n        onCommands[slot].execute();\r\n    }\r\n\r\n    public void offButtonWasPushed(int slot) {\r\n        offCommands[slot].execute();\r\n    }\r\n\r\n    public String toString() { // \u5217\u5370\u51fa\u6bcf\u4e00\u500b\u4f4d\u7f6e\u53ca\u5176command\uff0c\u6e2c\u8a66\u6642\u4f7f\u7528\u5230\u5b83\r\n        StringBuffer stringBuff = new StringBuffer();\r\n        stringBuff.append("\\n------ Remote Control -------\\n");\r\n        for (int i = 0; i < onCommands.length; i++) {\r\n            stringBuff.append("[slot " + i + "] " + onCommands[i].getClass().getName()\r\n                + "    " + offCommands[i].getClass().getName() + "\\n");\r\n        }\r\n        return stringBuff.toString();\r\n    }\r\n}\n'})}),"\n",(0,o.jsxs)(e.ol,{start:"4",children:["\n",(0,o.jsx)(e.li,{children:"\u5be6\u4f5c Command\uff0c\u4f7f\u7528\u4e0a\u9762\u5beb\u597d\u7684 LightOnCommand\uff0c\u4ee5\u53ca\u70ba Stereo \u7de8\u5beb On command"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"// Light on command\r\npublic class LightOnCommand implements Command {\r\n    Light light;\r\n\r\n    public LightOnCommand(Light light) {\r\n        this.light = light;\r\n    }\r\n\r\n    public void execute() {\r\n        light.on();\r\n    }\r\n}\r\n\r\n// stereo On with CD command\r\npublic class StereoOnWithCDCommand implements Command {\r\n    Stereo stereo;\r\n\r\n    public StereoOnWithCDCommand(Stereo stereo) {\r\n        this.stereo = stereo; /// \u6211\u5011\u63a5\u6536\u8981\u63a7\u5236\u7684stereo\u5be6\u4f8b\uff0c\u4e26\u5c07\u5b83\u5b58\u5165\u5be6\u4f8b\u8b8a\u6578\r\n    }\r\n\r\n    public void execute() {\r\n        stereo.on(); // \u5c07\u5b83\u6253\u958b\r\n        stereo.setCD(); // \u8a2d\u5b9a\u64ad\u653eCD\r\n        stereo.setVolume(11); // \u5c07\u97f3\u91cf\u8a2d\u621011\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"5",children:["\n",(0,o.jsx)(e.li,{children:"\u9010\u6b65\u6e2c\u8a66\u9059\u63a7\u5668"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class RemoteLoader {\r\n\r\n    public static void main(String[] args) {\r\n        RemoteControl remoteControl = new RemoteControl();\r\n\r\n        // \u5728\u5408\u9069\u7684\u4f4d\u7f6e\u5efa\u7acb\u6240\u6709\u7684\u8a2d\u5099\r\n        Light livingRoomLight = new Light("Living Room");\r\n        Light kitchenLight = new Light("Kitchen");\r\n        CeilingFan ceilingFan= new CeilingFan("Living Room");\r\n        GarageDoor garageDoor = new GarageDoor("Garage");\r\n        Stereo stereo = new Stereo("Living Room");\r\n\r\n        // \u5efa\u7acb\u6240\u6709\u7684Light Command\r\n        LightOnCommand livingRoomLightOn =\r\n                new LightOnCommand(livingRoomLight);\r\n        LightOffCommand livingRoomLightOff =\r\n                new LightOffCommand(livingRoomLight);\r\n        LightOnCommand kitchenLightOn =\r\n                new LightOnCommand(kitchenLight);\r\n        LightOffCommand kitchenLightOff =\r\n                new LightOffCommand(kitchenLight);\r\n\r\n        // \u5efa\u7acb\u540a\u6247\u7684On\u8207Off Command\r\n        CeilingFanOnCommand ceilingFanOn =\r\n                new CeilingFanOnCommand(ceilingFan);\r\n        CeilingFanOffCommand ceilingFanOff =\r\n                new CeilingFanOffCommand(ceilingFan);\r\n\r\n        // \u5efa\u7acb\u8eca\u5eab\u7684Up\u8207Down Command\r\n        GarageDoorUpCommand garageDoorUp =\r\n                new GarageDoorUpCommand(garageDoor);\r\n        GarageDoorDownCommand garageDoorDown =\r\n                new GarageDoorDownCommand(garageDoor);\r\n\r\n        // \u5efa\u7acb\u97f3\u97ff\u7684On\u8207Off Command\r\n        StereoOnWithCDCommand stereoOnWithCD =\r\n                new StereoOnWithCDCommand(stereo);\r\n        StereoOffCommand  stereoOff =\r\n                new StereoOffCommand(stereo);\r\n\r\n        // \u5b8c\u6210\u6240\u6709command\u4e4b\u5f8c\uff0c\u5c07\u4ed6\u5011\u8f09\u5165\u9059\u63a7\u5668\u7684\u4f4d\u7f6e\r\n        remoteControl.setCommand(0, livingRoomLightOn, livingRoomLightOff);\r\n        remoteControl.setCommand(1, kitchenLightOn, kitchenLightOff);\r\n        remoteControl.setCommand(2, ceilingFanOn, ceilingFanOff);\r\n        remoteControl.setCommand(3, stereoOnWithCD, stereoOff);\r\n\r\n        // \u5229\u7528toString()\u65b9\u6cd5\uff0c\u5370\u51fa\u6bcf\u4e00\u500b\u9059\u63a7\u5668\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u6307\u6d3e\u7d66\u5b83\u7684command\r\n        System.out.println(remoteControl);\r\n\r\n        // \u9010\u6b65\u6309\u4e0b\u6bcf\u4e00\u500b\u4f4d\u7f6e\u7684on\u548coff\r\n        remoteControl.onButtonWasPushed(0);\r\n        remoteControl.offButtonWasPushed(0);\r\n        remoteControl.onButtonWasPushed(1);\r\n        remoteControl.offButtonWasPushed(1);\r\n        remoteControl.onButtonWasPushed(2);\r\n        remoteControl.offButtonWasPushed(2);\r\n        remoteControl.onButtonWasPushed(3);\r\n        remoteControl.offButtonWasPushed(3);\r\n    }\r\n}\n'})}),"\n",(0,o.jsxs)(e.ol,{start:"6",children:["\n",(0,o.jsx)(e.li,{children:"\u5efa\u7acb NoCommand \u4ee5\u53d6\u4ee3 if \u5224\u65b7"}),"\n"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u70ba\u4e86\u907f\u514d\u6bcf\u6b21\u5f15\u7528\u4f4d\u7f6e\u90fd\u8981\u6aa2\u67e5\u5b83\u6709\u6c92\u6709\u8f09\u5165 command"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public void onButtonWasPushed(int slot) {\r\n    if (onCommands[slot] != null) { // \u770b\u8d77\u4f86\u5f88\u919c\r\n        onCommands[slot].execute();\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u5275\u5efa\u4e00\u500b\u4e0d\u505a\u4efb\u4f55\u4e8b\u60c5\u7684 command"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public class NoCommand implements Command {\r\n    public void execute() { }\r\n}\r\n\n"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u5728\u4e0a\u9762\u4f8b\u5b50\u4e2d RemoteControl \u7684\u5efa\u69cb\u5f0f\u4e2d\uff0c\u5c07 NoCommand \u9810\u5148\u6307\u6d3e\u7d66\u6bcf\u4e00\u500b\u4f4d\u7f6e\uff0c\u6bcf\u4e00\u500b\u4f4d\u7f6e\u5c31\u4e00\u5b9a\u6709\u4e00\u500b command \u53ef\u4ee5\u547c\u53eb"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"Command noCommand = new NoCommand();\r\nfor (int i = 0; i < 7; i++) {\r\n    onCommands[i] = noCommand;\r\n    offCommands[i] = noCommand;\r\n}\n"})}),"\n",(0,o.jsxs)(e.admonition,{type:"note",children:[(0,o.jsxs)(e.p,{children:["NoCommand \u662f\u4e00\u500b",(0,o.jsx)(e.strong,{children:"null \u7269\u4ef6"}),"\u3002null \u7269\u4ef6\u5f88\u9069\u5408\u5728\u4f60\u7121\u6cd5\u56de\u50b3\u6709\u610f\u7fa9\u7684\u7269\u4ef6\uff0c\u800c\u4e14\u4e0d\u60f3\u8b93\u7528\u6236\u7aef\u8655\u7406",(0,o.jsx)(e.strong,{children:"\u6c92\u6709\u6771\u897f\u53ef\u7528\u7684(null)\u7684\u60c5\u6cc1"}),"\u6642\u4f7f\u7528\u3002"]}),(0,o.jsx)(e.p,{children:"\u4f60\u6703\u767c\u73fe\u5f88\u591a\u8a2d\u8a08\u6a21\u5f0f\u90fd\u6709 Null \u7269\u4ef6\uff0c\u751a\u81f3\u6709\u4eba\u5c07\u300cNull Object\u300d\u8996\u70ba\u4e00\u7a2e\u8a2d\u8a08\u6a21\u5f0f"})]}),"\n",(0,o.jsx)(e.h3,{id:"\u6587\u4ef6\u64b0\u5beb",children:"\u6587\u4ef6\u64b0\u5beb"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"\u9059\u63a7\u5668\u8a2d\u8a08API",src:r(1126).A+"",width:"2676",height:"1764"})}),"\n",(0,o.jsx)(e.h3,{id:"\u4f7f\u7528-lambda-\u512a\u5316",children:"\u4f7f\u7528 lambda \u512a\u5316"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'// \u539f\u59cb\u7684\u5beb\u6cd5\r\npublic class RemoteLoader {\r\n\r\n    public static void main(String[] args) {\r\n        RemoteControl remoteControl = new RemoteControl();\r\n\r\n        Light livingRoomLight = new Light("Living Room");\r\n\r\n        LightOnCommand livingRoomLightOn =\r\n                new LightOnCommand(livingRoomLight); // \u53ef\u4ee5\u79fb\u9664\u5177\u9ad4\u7684Command\u7269\u4ef6\r\n        LightOffCommand livingRoomLightOff =\r\n                new LightOffCommand(livingRoomLight);\r\n\r\n        remoteControl.setCommand(0, livingRoomLightOn, livingRoomLightOff);\r\n    }\r\n}\r\n\r\n// \u4f7f\u7528lambda\u5beb\u6cd5\r\npublic class RemoteLoader {\r\n\r\n    public static void main(String[] args) {\r\n        RemoteControl remoteControl = new RemoteControl();\r\n\r\n        Light livingRoomLight = new Light("Living Room");\r\n\r\n        remoteControl.setCommand(0, () -> livingRoomLight.on(),\r\n                                    () -> livingRoomLight.off()); // \u6211\u5011\u5c07\u5177\u9ad4command\u5beb\u6210lambda\u904b\u7b97\u5f0f\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.admonition,{type:"note",children:(0,o.jsxs)(e.p,{children:["\u9019\u7a2e\u505a\u6cd5\u53ea\u80fd\u5728 Command \u4ecb\u9762\u53ea\u6709",(0,o.jsx)(e.strong,{children:"\u4e00\u500b"}),"\u62bd\u8c61\u65b9\u6cd5\u6642\u4f7f\u7528\uff0c\u4e00\u65e6\u52a0\u5728\u7b2c\u4e8c\u500b\u62bd\u8c61\u65b9\u6cd5\uff0clambda \u7c21\u5beb\u5c31\u7121\u6cd5\u4f7f\u7528"]})}),"\n",(0,o.jsx)(e.h2,{id:"\u5fa9\u539f\u6309\u9215",children:"\u5fa9\u539f\u6309\u9215"}),"\n",(0,o.jsx)(e.h3,{id:"\u96fb\u71c8\u958b\u95dc\u6062\u5fa9",children:"\u96fb\u71c8\u958b\u95dc\u6062\u5fa9"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u5047\u8a2d\u5ba2\u5ef3\u7684\u96fb\u71c8\u662f\u95dc\u9589\u7684\uff0c\u7576\u6309\u4e0b on \u4e4b\u5f8c\uff0c\u96fb\u71c8\u6703\u958b\u555f\u3002\u7576\u4f60\u6309\u4e0b\u5fa9\u539f\u7684\u6642\u5019\uff0c\u7406\u8ad6\u4e0a\u96fb\u71c8\u6703\u95dc\u9589\u3002"}),"\n"]}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u8b93 Command \u4ecb\u9762\u53ef\u4ee5\u652f\u63f4\u5fa9\u539f\uff0c\u56e0\u6b64\u5efa\u7acb\u4e00\u500b execute()\u65b9\u6cd5\u5c0d\u61c9\u7684 undo()\u65b9\u6cd5"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public interface Command {\r\n    public void execute();\r\n    public void undo(); // \u5efa\u7acb\u4e00\u500b\u65b0\u7684undo\u65b9\u6cd5\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"2",children:["\n",(0,o.jsx)(e.li,{children:"\u6211\u5011\u5148\u8655\u7406\u7c21\u55ae\u7684 LightOnCommand\uff0c\u5982\u679c On \u5c31\u662f\u4e0a\u4e00\u6b21\u88ab\u547c\u53eb\u7684\u65b9\u6cd5\uff0c\u6211\u5011\u77e5\u9053 undo \u5fc5\u9808\u547c\u53eb Off \u65b9\u6cd5\uff0cLightOffCommand \u540c\u7406"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public class LightOnCommand implements Command {\r\n    Light light;\r\n    public LightOnCommand(Light light) {\r\n        this.light = light;\r\n    }\r\n\r\n    public void execute() {\r\n        light.on();\r\n    }\r\n\r\n    public void undo() { // execute \u6703\u5c07\u96fb\u71c8\u958b\u8d77\uff0c\u6240\u4ee5undo\u53ea\u8981\u5c07\u96fb\u71c8\u95dc\u9589\u5373\u53ef\r\n        light.off();\r\n    }\r\n}\r\n\r\npublic class LightOffCommand implements Command {\r\n    Light light;\r\n    public LightOffCommand(Light light) {\r\n        this.light = light;\r\n    }\r\n\r\n    public void execute() {\r\n        light.off();\r\n    }\r\n\r\n    public void undo() { // \u540c\u7406undo\u5c07\u96fb\u71c8\u958b\u8d77\r\n        light.on();\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"3",children:["\n",(0,o.jsx)(e.li,{children:"\u6211\u5011\u5fc5\u9808\u8b93\u9059\u63a7\u5668\u8ffd\u8e64\u4e0a\u4e00\u6b21\u88ab\u6309\u4e0b\u7684\u6309\u9215\u4ee5\u53ca undo \u6309\u9215\u3002\u5728 Remote Control \u985e\u5225\u4e2d\uff0c\u52a0\u5165\u4e00\u500b\u65b0\u7684\u5be6\u4f8b\u8b8a\u6578\u4f86\u8a18\u9304\u4e0a\u4e00\u500b\u547c\u53eb\u7684 command\uff0c\u7576 undo \u6309\u4e0b\u6642\uff0c\u8b80\u53d6\u90a3\u500b command\uff0c\u4e26\u547c\u53eb\u5b83\u7684 undo()\u65b9\u6cd5"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class RemoteControlWithUndo {\r\n    Command[] onCommands;\r\n    Command[] offCommands;\r\n    Command undoCommand; // \u5c07\u4e0a\u4e00\u6b21\u57f7\u884c\u7684command\u5b58\u5728\u9019\u88e1\uff0c\u8b93undo\u6309\u9215\u4f7f\u7528\r\n\r\n    public RemoteControlWithUndo() {\r\n        onCommands = new Command[7];\r\n        offCommands = new Command[7];\r\n\r\n        Command noCommand = new NoCommand();\r\n        for(int i=0;i<7;i++) {\r\n            onCommands[i] = noCommand;\r\n            offCommands[i] = noCommand;\r\n        }\r\n        undoCommand = noCommand; // undo\u8207\u5176\u4ed6\u7684\u4f4d\u7f6e\u4e00\u6a23\uff0c\u5728\u4e00\u958b\u59cb\u88ab\u8a2d\u5b9a\u70baNoCommand\uff0c\u6240\u4ee5\u5728\u6309\u4e0b\u4efb\u4f55\u5176\u4ed6\u6309\u9215\u4e4b\u524d\uff0c\u6309\u4e0bundo\u4e0d\u6703\u505a\u4efb\u4f55\u4e8b\u60c5\r\n    }\r\n\r\n    public void setCommand(int slot, Command onCommand, Command offCommand) {\r\n        onCommands[slot] = onCommand;\r\n        offCommands[slot] = offCommand;\r\n    }\r\n\r\n    public void onButtonWasPushed(int slot) {\r\n        onCommands[slot].execute();\r\n        undoCommand = onCommands[slot]; // \u5c07\u4ed6\u7684\u53c3\u8003\u5b58\u5165undoCommand\u4e4b\u4e2d\r\n    }\r\n\r\n    public void offButtonWasPushed(int slot) {\r\n        offCommands[slot].execute();\r\n        undoCommand = offCommands[slot]; // \u5c07\u4ed6\u7684\u53c3\u8003\u5b58\u5165undoCommand\u4e4b\u4e2d\r\n    }\r\n\r\n    public void undoButtonWasPushed() { // \u7576undo\u6309\u9215\u88ab\u6309\u4e0b\u6642\uff0c\u6211\u5011\u547c\u53ebundoCommand\u6240\u5132\u5b58\u7684command\u7684undo\u65b9\u6cd5()\uff0c\u5b83\u6703\u6062\u5fa9\u4e0a\u4e00\u6b21\u57f7\u884c\u7684command\u52d5\u4f5c\u3002\r\n        undoCommand.undo();\r\n    }\r\n\r\n    public String toString() {\r\n        StringBuffer stringBuff = new StringBuffer();\r\n        stringBuff.append("\\n------ Remote Control -------\\n");\r\n        for (int i = 0; i < onCommands.length; i++) {\r\n            stringBuff.append("[slot " + i + "] " + onCommands[i].getClass().getName()\r\n                + "    " + offCommands[i].getClass().getName() + "\\n");\r\n        }\r\n        stringBuff.append("[undo] " + undoCommand.getClass().getName() + "\\n"); // \u52a0\u5165undo\u7684\u6e2c\u8a66\r\n        return stringBuff.toString();\r\n    }\r\n}\n'})}),"\n",(0,o.jsxs)(e.ol,{start:"4",children:["\n",(0,o.jsx)(e.li,{children:"\u6e2c\u8a66\u96fb\u71c8\u6062\u5fa9"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class RemoteLoader {\r\n\r\n    public static void main(String[] args) {\r\n        RemoteControlWithUndo remoteControl = new RemoteControlWithUndo();\r\n\r\n        Light livingRoomLight = new Light("Living Room");\r\n\r\n        LightOnCommand livingRoomLightOn =\r\n                new LightOnCommand(livingRoomLight);\r\n        LightOffCommand livingRoomLightOff =\r\n                new LightOffCommand(livingRoomLight);\r\n\r\n        remoteControl.setCommand(0, livingRoomLightOn, livingRoomLightOff);\r\n\r\n        remoteControl.onButtonWasPushed(0); // Light is on\r\n        remoteControl.offButtonWasPushed(0); // Light is off\r\n        System.out.println(remoteControl); // [undo] LightOffCommand\r\n        remoteControl.undoButtonWasPushed(); // Light is on\r\n        remoteControl.offButtonWasPushed(0); // Light is off\r\n        remoteControl.onButtonWasPushed(0); // Light is on\r\n        System.out.println(remoteControl); // [undo] LightOnCommand\r\n        remoteControl.undoButtonWasPushed(); // Light is off\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"\u4f7f\u7528\u72c0\u614b\u4f86\u5be6\u4f5c\u6062\u5fa9",children:"\u4f7f\u7528\u72c0\u614b\u4f86\u5be6\u4f5c\u6062\u5fa9"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u4f8b\u5982 CeilingFan \u53ef\u4ee5\u8a2d\u5b9a\u4e00\u4e9b\u901f\u5ea6\uff0c\u4e5f\u6709 OFF \u65b9\u6cd5"}),"\n"]}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u67e5\u770b CeilingFan \u7684\u539f\u59cb\u78bc"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class CeilingFan {\r\n    public static final int HIGH = 3;\r\n    public static final int MEDIUM = 2;\r\n    public static final int LOW = 1;\r\n    public static final int OFF = 0;\r\n    String location;\r\n    int speed; // \u985e\u5225\u4fdd\u5b58\u4e00\u4e9b\u5340\u57df\u72c0\u614b\uff0c\u4ee3\u8868\u540a\u6247\u7684\u901f\u5ea6\r\n\r\n    public CeilingFan(String location) {\r\n        this.location = location;\r\n        speed = OFF;\r\n    }\r\n\r\n    // \u7528\u9019\u4e9b\u65b9\u6cd5\u8a2d\u5b9a\u540a\u6247\u7684\u901f\u5ea6\r\n    public void high() {\r\n        speed = HIGH;\r\n        System.out.println(location + " ceiling fan is on high");\r\n    }\r\n\r\n    public void medium() {\r\n        speed = MEDIUM;\r\n        System.out.println(location + " ceiling fan is on medium");\r\n    }\r\n\r\n    public void low() {\r\n        speed = LOW;\r\n        System.out.println(location + " ceiling fan is on low");\r\n    }\r\n\r\n    public void off() {\r\n        speed = OFF;\r\n        System.out.println(location + " ceiling fan is off");\r\n    }\r\n\r\n    // \u53ef\u4ee5\u4f7f\u7528\u9019\u500b\u65b9\u6cd5\u53d6\u5f97\u76ee\u524d\u540a\u6247\u7684\u901f\u5ea6\r\n    public int getSpeed() {\r\n        return speed;\r\n    }\r\n}\n'})}),"\n",(0,o.jsxs)(e.ol,{start:"2",children:["\n",(0,o.jsx)(e.li,{children:"\u70ba\u540a\u6247\u7684 command \u52a0\u5165\u6062\u5fa9\u529f\u80fd"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public class CeilingFanHighCommand implements Command { // High\u3001Medium\u3001Low\u3001Off\u5404\u9700\u8981\u4e00\u500bcommand\u7269\u4ef6\r\n    CeilingFan ceilingFan;\r\n    int prevSpeed; // \u52a0\u5165\u5340\u57df\u8b8a\u6578\u4f86\u8a18\u9304\u540a\u6247\u4e0a\u4e00\u6b21\u7684\u901f\u5ea6\r\n\r\n    public CeilingFanHighCommand(CeilingFan ceilingFan) {\r\n        this.ceilingFan = ceilingFan;\r\n    }\r\n\r\n    public void execute() {\r\n        prevSpeed = ceilingFan.getSpeed(); // \u518d\u66f4\u6539\u540a\u6247\u901f\u5ea6\u524d\uff0c\u5148\u8a18\u9304\u4ed6\u4e4b\u524d\u7684\u72c0\u614b\uff0c\u5728\u6062\u5fa9\u7684\u6642\u5019\u4f7f\u7528\r\n        ceilingFan.high();\r\n    }\r\n\r\n    public void undo() { // \u5728\u6062\u5fa9\u6642\uff0c\u5c07\u540a\u6247\u7684\u901f\u5ea6\u8a2d\u56de\u53bb\u4ed6\u4e4b\u524d\u7684\u901f\u5ea6\r\n        if (prevSpeed == CeilingFan.HIGH) {\r\n            ceilingFan.high();\r\n        } else if (prevSpeed == CeilingFan.MEDIUM) {\r\n            ceilingFan.medium();\r\n        } else if (prevSpeed == CeilingFan.LOW) {\r\n            ceilingFan.low();\r\n        } else if (prevSpeed == CeilingFan.OFF) {\r\n            ceilingFan.off();\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"3",children:["\n",(0,o.jsx)(e.li,{children:"\u6e2c\u8a66\u540a\u6247"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'\r\npackage headfirst.designpatterns.command.undo;\r\n\r\npublic class RemoteLoader {\r\n\r\n    public static void main(String[] args) {\r\n        RemoteControlWithUndo remoteControl = new RemoteControlWithUndo();\r\n\r\n        CeilingFan ceilingFan = new CeilingFan("Living Room");\r\n\r\n        // \u9019\u88e1\u5be6\u4f8b\u5316\u4e09\u500bcommand\r\n        CeilingFanMediumCommand ceilingFanMedium =\r\n                new CeilingFanMediumCommand(ceilingFan);\r\n        CeilingFanHighCommand ceilingFanHigh =\r\n                new CeilingFanHighCommand(ceilingFan);\r\n        CeilingFanOffCommand ceilingFanOff =\r\n                new CeilingFanOffCommand(ceilingFan);\r\n\r\n        // \u5c07medium\u653e\u5165\u7b2c0\u500b\u4f4d\u7f6e\uff0c\u5c07high\u653e\u5165\u7b2c1\u500b\u4f4d\u7f6e\uff0c\u4e26\u4e14\u4e5f\u8f09\u5165off command\r\n        remoteControl.setCommand(0, ceilingFanMedium, ceilingFanOff);\r\n        remoteControl.setCommand(1, ceilingFanHigh, ceilingFanOff);\r\n\r\n        remoteControl.onButtonWasPushed(0); // Living Room ceiling fan is on medium\r\n        remoteControl.offButtonWasPushed(0); // Living Room ceiling fan is off\r\n        System.out.println(remoteControl); // [undo] CeilingFanOffCommand\r\n        remoteControl.undoButtonWasPushed(); // Living Room ceiling fan is on medium\r\n\r\n        remoteControl.onButtonWasPushed(1); // Living Room ceiling fan is on high\r\n        System.out.println(remoteControl); // [undo] CeilingFanHighCommand\r\n        remoteControl.undoButtonWasPushed(); // Living Room ceiling fan is on medium\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"\u6b77\u53f2\u7d00\u9304\u7684\u65b9\u6cd5",children:"\u6b77\u53f2\u7d00\u9304\u7684\u65b9\u6cd5"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u76f4\u63a5\u5132\u5b58(Reference)"}),"\n",(0,o.jsx)(e.li,{children:"Clone \u4e00\u500b\u65b0\u7684\u547d\u4ee4\u5728\u5132\u5b58"}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["\u7b2c\u4e8c\u500b\u662f\u56e0\u70ba\uff1a\u4f60\u7121\u6cd5\u78ba\u4fdd\u57f7\u884c\u547d\u4ee4\u5f8c\uff0c",(0,o.jsx)(e.strong,{children:"\u8a72\u547d\u4ee4\u7269\u4ef6\u4e0d\u6703\u7522\u751f\u8b8a\u5316\uff0c\u6216\u91cd\u8907\u547c\u53eb"}),"\uff0c\u8907\u88fd\u4e00\u4efd\u53ef\u4ee5\u78ba\u4fdd\u5176\u4e7e\u6de8\u72c0\u614b(Clean State)\uff0c\u9019\u4e5f\u662f Prototype \u6a21\u5f0f\u7684\u61c9\u7528"]}),"\n",(0,o.jsx)(e.admonition,{type:"note",children:(0,o.jsxs)(e.p,{children:["\u547d\u4ee4\u6a21\u5f0f\u5be6\u52d9\u4e0a\u4e5f\u7d93\u5e38\u4f7f\u7528 ",(0,o.jsx)(e.strong,{children:"\u62bd\u8c61\u985e\u5225"}),"\uff0c\u4f86\u5be6\u73fe\u6a21\u677f\u65b9\u6cd5(Template method)\uff0c\u6216\u5132\u5b58 Receiver \u72c0\u614b\u7b49\u5171\u7528\u529f\u80fd"]})}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["\u4f7f\u7528\u64f4\u5c55\u65b9\u6cd5 undo()\u7684\u65b9\u5f0f\uff0c\u70ba\u4e86\u5be6\u73fe",(0,o.jsxs)(e.strong,{children:["\u516c\u5171\u529f\u80fd(Cloneable)",(0,o.jsx)(e.strong,{children:"\u5c07 Command \u4ecb\u9762\u6539\u6210"}),"\u62bd\u8c61\u985e\u5225"]})]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public abstract class Command implements Cloneable{\r\n    public abstract void execute();\r\n    public abstract void undo();\r\n\r\n    @Override\r\n    public Object clone() throws CloneNotSupportedException {\r\n        return super.clone();\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"2",children:["\n",(0,o.jsx)(e.li,{children:"Receiver \u4e0d\u7528\u66f4\u6539\uff0cInvoker \u4f7f\u7528 Stack \u7684\u65b9\u5f0f\u5132\u5b58\uff0c\u5132\u5b58\u7684\u70ba Clone \u5f8c\u7684\u547d\u4ee4\uff0c\u800c\u975e Reference"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class InvokerWithHistory {\r\n    private Queue<Command> commands = new LinkedList<>(); // \u5de8\u96c6\u4f47\u5217\u547d\u4ee4\r\n\r\n    private Stack<Command> history = new Stack<>(); // stack \u6b77\u53f2\u7d00\u9304\r\n\r\n    public InvokerWithHistory() {\r\n    }\r\n\r\n    public void addCommand(Command command) {\r\n        commands.offer(command);\r\n    }\r\n\r\n    public void cancelCommand(Command command) {\r\n        commands.remove(command);\r\n    }\r\n\r\n    public void undo() {\r\n        if (!history.isEmpty()) {\r\n            Command command = history.pop();\r\n            command.undo();\r\n        } else {\r\n            System.out.println("[\u5fa9\u539f\u5931\u6557] --- \u67e5\u7121\u7d00\u9304");\r\n        }\r\n    }\r\n\r\n    public void do() {\r\n        while (!commands.isEmpty()) {\r\n            Command command = commands.poll();\r\n            command.execute();\r\n\r\n            addHistoryByClone(command); // \u57f7\u884c\u904e\u5f8c\uff0c\u7528Clone\u7684\u65b9\u5f0f\u5132\u5b58Command\r\n        }\r\n    }\r\n\r\n    private void addHistoryByClone(Command command) {\r\n        Command commandClone = null;\r\n        try {\r\n            commandClone = (Command) command.clone();\r\n        } catch (CloneNotSupportedException e) {\r\n            e.printStackTrace();\r\n        }\r\n        history.push(commandClone);\r\n    }\r\n\r\n    private void addHistoryByReference(Command command) {\r\n        history.push(command);\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u4f7f\u7528\u5de8\u96c6-command\u6d3e\u5c0d\u6a21\u5f0f",children:"\u4f7f\u7528\u5de8\u96c6 Command(\u6d3e\u5c0d\u6a21\u5f0f)"}),"\n",(0,o.jsx)(e.h3,{id:"\u9700\u6c42",children:"\u9700\u6c42"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u5e0c\u671b\u9059\u63a7\u5668\u53ef\u4ee5\u7528\u4e00\u9846\u6309\u9215\u540c\u6642\u8abf\u6697\u71c8\u5149\u3001\u6253\u958b\u97f3\u97ff\u548c\u96fb\u8996\u3001\u8b93\u71b1\u6c34\u6d74\u7f38\u958b\u59cb\u52a0\u6eab"}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"\u5275\u5efa\u5de8\u96c6\u7684-command",children:"\u5275\u5efa\u5de8\u96c6\u7684 Command"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u88fd\u4f5c\u4e00\u7a2e\u65b0\u7684 Command\uff0c\u8b93\u4ed6\u53ef\u4ee5\u57f7\u884c\u5176\u4ed6\u591a\u500b Command"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public class MacroCommand implements Command {\r\n    Command[] commands;\r\n\r\n    public MacroCommand(Command[] commands) { // \u63a5\u6536\u4e00\u500bCommand\u9663\u5217\uff0c\u4e26\u5b58\u5165MacroCommand\r\n        this.commands = commands;\r\n    }\r\n\r\n    public void execute() {\r\n        for (int i = 0; i < commands.length; i++) { // \u7576\u9059\u63a7\u5668\u57f7\u884c\u5de8\u96c6\u6642\uff0c\u4e00\u6b21\u57f7\u884c\u9019\u4e9bcommand\r\n            commands[i].execute();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * NOTE:  these commands have to be done backwards to ensure\r\n     * proper undo functionality\r\n     */\r\n    public void undo() {\r\n        for (int i = commands.length -1; i >= 0; i--) {\r\n            commands[i].undo();\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"2",children:["\n",(0,o.jsx)(e.li,{children:"\u4f7f\u7528\u5de8\u96c6 Command"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class RemoteLoader {\r\n\r\n    public static void main(String[] args) {\r\n\r\n        RemoteControl remoteControl = new RemoteControl();\r\n\r\n        // \u5efa\u7acb\u6240\u6709\u7684\u8a2d\u5099\uff1a\u96fb\u71c8\u3001\u96fb\u8996\u3001\u97f3\u97ff\u3001\u71b1\u6c34\u6d74\u7f38\r\n        Light light = new Light("Living Room");\r\n        TV tv = new TV("Living Room");\r\n        Stereo stereo = new Stereo("Living Room");\r\n        Hottub hottub = new Hottub();\r\n\r\n        // \u5efa\u7acb\u6240\u6709\u7684ON\u3001OFF Command\u4f86\u63a7\u5236\u4ed6\u5011\r\n        LightOnCommand lightOn = new LightOnCommand(light);\r\n        StereoOnCommand stereoOn = new StereoOnCommand(stereo);\r\n        TVOnCommand tvOn = new TVOnCommand(tv);\r\n        HottubOnCommand hottubOn = new HottubOnCommand(hottub);\r\n        LightOffCommand lightOff = new LightOffCommand(light);\r\n        StereoOffCommand stereoOff = new StereoOffCommand(stereo);\r\n        TVOffCommand tvOff = new TVOffCommand(tv);\r\n        HottubOffCommand hottubOff = new HottubOffCommand(hottub);\r\n\r\n        // \u5efa\u7acbOn Command\u7684\u9663\u5217\u3001Off Command\u7684\u9663\u5217\r\n        Command[] partyOn = { lightOn, stereoOn, tvOn, hottubOn};\r\n        Command[] partyOff = { lightOff, stereoOff, tvOff, hottubOff};\r\n\r\n        // \u4e26\u5efa\u7acb\u5169\u500b\u5c0d\u61c9\u7684\u5de8\u96c6\u4f86\u4fdd\u5b58\u4ed6\u5011\r\n        MacroCommand partyOnMacro = new MacroCommand(partyOn);\r\n        MacroCommand partyOffMacro = new MacroCommand(partyOff);\r\n\r\n        // \u5c07\u5de8\u96c6command\u6307\u6d3e\u7d66\u6309\u9215\uff0c\u548c\u8655\u7406\u4efb\u4f55command\u4e00\u6a23\r\n        remoteControl.setCommand(0, partyOnMacro, partyOffMacro);\r\n\r\n        System.out.println(remoteControl);\r\n        System.out.println("--- Pushing Macro On---");\r\n        remoteControl.onButtonWasPushed(0);\r\n        /*\r\n            Light is on\r\n            Living Room stereo is on\r\n            Living Room TV is on\r\n            Living Room TV channel is set for DVD\r\n            Hottub is heating to a steaming 104 degrees\r\n            Hottub is bubbling!\r\n        */\r\n        System.out.println("--- Pushing Macro Off---");\r\n        remoteControl.offButtonWasPushed(0);\r\n        /*\r\n            Light is off\r\n            Living Room stereo is off\r\n            Living Room TV is off\r\n            Hottub is cooling to 98 degrees\r\n        */\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u6c92\u6709\u8822\u554f\u984c",children:"\u6c92\u6709\u8822\u554f\u984c"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Q: \u4e00\u5b9a\u8981\u4f7f\u7528 receiver \u55ce\uff1f\u70ba\u4f55\u4e0d\u8b93 command \u7269\u4ef6\u5be6\u4f5c execute()\u65b9\u6cd5\u7684\u7d30\u7bc0\uff1f"})}),"\n",(0,o.jsx)(e.p,{children:"A: \u901a\u5e38\u6211\u5011\u6703\u76e1\u91cf\u8a2d\u8a08\u53ea\u77e5\u9053\u5982\u4f55\u547c\u53eb receiver \u7684\u300c\u7b28\u300dcommand \u7269\u4ef6\u3002\u4f46\u662f\u4f60\u4e5f\u6703\u770b\u5230\u5f88\u591a\u300c\u8070\u660e\u7684\u300dcommand \u7269\u4ef6\uff0c\u5b83\u5011\u5be6\u4f5c\u4e86\u57f7\u884c\u8acb\u6c42\u6240\u9700\u7684\u5927\u90e8\u5206(\u751a\u81f3\u5230\u5168\u90e8\u7684)\u908f\u8f2f\u3002\u4e0d\u904e\u5982\u6b64\u4e00\u4f86\uff0cinvoker \u548c receiver \u4e4b\u9593\u7684\u89e3\u5076\u5408\u7a0b\u5ea6\u5c31\u6c92\u6709\u90a3\u9ebc\u597d\u4e86\uff0c\u4e5f\u7121\u6cd5\u5c07 receiver \u7576\u6210\u53c3\u6578\u50b3\u7d66 command"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Q: \u600e\u9ebc\u505a\u51fa\u5fa9\u539f\u64cd\u4f5c\u7684\u6b77\u53f2\u7d00\u9304\uff1f\u6211\u60f3\u8981\u8b93 undo \u6309\u9215\u53ef\u4ee5\u6309\u4e0b\u5f88\u591a\u6b21"})}),"\n",(0,o.jsx)(e.p,{children:"A: \u53ef\u4ee5\u7528\u4e00\u500b stack \u4f86\u4fdd\u5b58\u57f7\u884c\u904e\u7684\u6240\u6709 command\uff0c\u7576 undo \u88ab\u6309\u4e0b\u6642\uff0c\u8b93 invoker \u5f9e\u5806\u758a pop \u51fa\u4e00\u500b command\uff0c\u4e26\u547c\u53eb\u5b83\u7684 undo()\u65b9\u6cd5"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Q: \u6211\u53ef\u4ee5\u5c07\u6d3e\u5c0d\u6a21\u5f0f\u5beb\u6210 Command \u55ce\uff1f\u5efa\u7acb\u4e00\u500b PartyCommand\uff0c\u4e26\u5c07\u57f7\u884c\u5176\u4ed6 Command \u7684\u547c\u53eb\u90fd\u653e\u5728 PartyCommand \u7684 execute()\u65b9\u6cd5\u88e1\u9762"})}),"\n",(0,o.jsx)(e.p,{children:"A: \u53ef\u4ee5\uff0c\u4f46\u9019\u6a23\u5c31\u5c07\u6d3e\u5c0d\u6a21\u5f0f\u300c\u5beb\u6b7b\u300d\u5728 PartyCommand \u88e1\u9762\u4e86\uff0c\u5982\u679c\u4f7f\u7528 MacroCommand\uff0c\u53ef\u4ee5\u52d5\u614b\u6c7a\u5b9a\u54ea\u4e9b Command\uff0c\u6703\u66f4\u52a0\u9748\u6d3b\u3002"}),"\n",(0,o.jsx)(e.h2,{id:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014-\u5c07\u8acb\u6c42\u4f47\u5217\u5316threadpoolexecutor",children:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014: \u5c07\u8acb\u6c42\u4f47\u5217\u5316(ThreadPoolExecutor)"}),"\n",(0,o.jsx)(e.p,{children:"Command \u53ef\u4ee5\u8b93\u6211\u5011\u5c07\u4e00\u500b\u904b\u7b97(\u4e00\u500b receiver \u548c\u4e00\u7d44\u52d5\u4f5c)\u5305\u88dd\u8d77\u4f86\uff0c\u8b93\u4f60\u5c07\u5b83\u7576\u6210\u4e00\u7d1a(first-class)\u7269\u4ef6\u5230\u8655\u50b3\u905e\u3002\u90a3\u4e9b\u8a08\u7b97\u53ef\u80fd\u5728 client \u61c9\u7528\u7a0b\u5f0f\u5efa\u7acb command \u7269\u4ef6\u5f88\u4e45\u4e4b\u5f8c\u624d\u88ab\u547c\u53eb\uff0c\u751a\u81f3\u53ef\u4ee5\u88ab\u4e0d\u540c\u7684\u57f7\u884c\u7dd2\u547c\u53eb\uff0c\u5229\u7528\u9019\u7a2e\u7279\u6027\u4f86\u5be6\u4f5c\u4f8b\u5982\u6392\u7a0b\u5668\u3001\u57f7\u884c\u7dd2\u6c60\u3001\u5de5\u4f5c\u4f47\u5217\u3002"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u62bd\u8c61\u547d\u4ee4 Command: Runnable \u4ecb\u9762"}),"\n",(0,o.jsx)(e.li,{children:"\u5177\u9ad4\u547d\u4ee4 ConcreteCommand: \u7531\u4f7f\u7528\u8005\u81ea\u5df1\u5275\u5efa\u9019\u500b\u985e\uff0c\u5be6\u73fe Runnable \u4ecb\u9762\uff0c\u91cd\u5beb run \u65b9\u6cd5\uff0c\u5728 run \u65b9\u6cd5\u4e2d\u5beb\u5177\u9ad4\u696d\u52d9\u908f\u8f2f\u3002(\u53ef\u80fd\u6703\u6301\u6709 Receiver)"}),"\n",(0,o.jsx)(e.li,{children:"\u767c\u9001\u8005 Invoker: ThreadPoolExecutor\uff0c\u4ed6\u6301\u6709\u4e00\u500b\u547d\u4ee4\u968a\u5217\uff0c\u4f7f\u7528\u8005\u53ef\u4ee5\u5411\u4ed6\u63d0\u4ea4\u8981\u57f7\u884c\u7684\u547d\u4ee4"}),"\n",(0,o.jsx)(e.li,{children:"\u63a5\u6536\u8005 Receiver: \u5e38\u5e38\u8207 Runnable \u5be6\u4f8b\u4e2d run \u65b9\u6cd5\u91cd\u758a\uff0c\u4e0d\u4e00\u5b9a\u6703\u6709"}),"\n",(0,o.jsx)(e.li,{children:"\u547d\u4ee4\u968a\u5217\uff1aBlockingQueue\uff0c\u4efb\u52d9\u963b\u585e\u968a\u5217\uff0c\u5be6\u969b\u4e0a\u5c31\u662f\u6a21\u5f0f\u4e2d\u7684\u547d\u4ee4\u968a\u5217"}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.img,{alt:"ThreadPoolExecutor",src:r(7962).A+"",width:"1353",height:"573"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public interface Runnable {\r\n    public abstract void run();\r\n}\n"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class ConcreteCommand implements Runnable {\r\n    @Override\r\n    public void run() {\r\n        System.out.println(Thread.currentThread().getName() + " is running")\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public class ThreadPoolExecutor {\r\n    private final BlockingQueue<Runnable> workQueue; // \u547d\u4ee4\u968a\u5217\r\n    public void execute(Runnable runnable) {/*\u8207\u547d\u4ee4\u6a21\u5f0f\u7121\u95dc*/} // \u52a0\u5165\u547d\u4ee4\u968a\u5217\r\n    final void runWorker(Worker w) {/*\u8207\u547d\u4ee4\u6a21\u5f0f\u7121\u95dc*/} // \u57f7\u884c\u547d\u4ee4\u968a\u5217\u4e2d\u6240\u6709\u547d\u4ee4\r\n}\n"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class ThreadPoolExecutorTest {\r\n    public static void main(String[] args) {\r\n        ThreadPoolExecutor pool = new ThreadPoolExecutor(5,\r\n                Runtime.getRuntime().availableProcessors() * 2,\r\n                60,\r\n                TimeUnit.SECONDS,\r\n                new ArrayBlockQueue<>(200),\r\n                new ThreadFactory() {\r\n                    @Override\r\n                    public Thread newThread(Runnable r) {\r\n                        Thread t = new Thread(r);\r\n                        t.setName("order-thread");\r\n                        return t;\r\n                    }\r\n                }, new ThreadPoolExecutor.AbortPolicy());\r\n\r\n        Runnable concreteCommand = new ConcreteCommand();\r\n\r\n        pool.execute(concreteCommand);\r\n\r\n        pool.shutdown();\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014-\u8a18\u9304\u8acb\u6c42",children:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014: \u8a18\u9304\u8acb\u6c42"}),"\n",(0,o.jsx)(e.admonition,{type:"note",children:(0,o.jsx)(e.p,{children:"\u547d\u4ee4\u7684\u5132\u5b58\u8207\u8f09\u5165(Store and Load)"})}),"\n",(0,o.jsxs)(e.p,{children:["\u6709\u4e9b\u61c9\u7528\u7a0b\u5f0f\u7684\u8a9e\u610f(semantic)\u8981\u6c42\u6211\u5011\u8a18\u9304\u6240\u6709\u7684\u52d5\u4f5c\uff0c\u4e26\u4e14\u5728\u7576\u6a5f\u6642\uff0c\u85c9\u8457\u91cd\u65b0\u547c\u53eb\u90a3\u4e9b\u52d5\u4f5c\u4f86\u5fa9\u539f\uff0c\u547d\u4ee4\u6a21\u5f0f\u53ef\u4ee5\u8b93\u6211\u5011\u85c9\u8457\u52a0\u5165",(0,o.jsx)(e.strong,{children:"store()\u8207 load()\u65b9\u6cd5"}),"\u4f86\u652f\u63f4\u9019\u7a2e\u8a9e\u610f\u3002\u5728 Java \u88e1\uff0c\u96d6\u7136\u6211\u5011\u53ef\u4ee5\u7528\u7269\u4ef6\u5e8f\u5217\u5316\u4f86\u5be6\u4f5c\u9019\u4e9b\u65b9\u6cd5\uff0c\u4f46\u662f\u5e8f\u5217\u5316\u4f86\u9032\u884c\u6301\u4e45\u4fdd\u5b58\u6642\u9700\u8981\u6ce8\u610f\u7684\u4e8b\u60c5\u4f9d\u7136\u5b58\u5728\u3002 (Java \u5e8f\u5217\u5316\u5c31\u662f\u5099\u5fd8\u9304\u6a21\u5f0f(Momento)\u7684\u4e00\u7a2e\u5be6\u4f5c)"]}),"\n",(0,o.jsx)(e.p,{children:"\u5728\u57f7\u884c command \u6642\uff0c\u6211\u5011\u5c07\u4ed6\u5011\u7684\u6b77\u53f2\u7d00\u9304\u5b58\u5165\u78c1\u789f\uff0c\u7576\u6a5f\u6642\uff0c\u6211\u5011\u91cd\u65b0\u8f09\u5165 command \u7269\u4ef6\uff0c\u4e26\u4f9d\u5e8f\u547c\u53eb\u4ed6\u5011\u7684 execute()\u3002"}),"\n",(0,o.jsx)(e.p,{children:"\u85c9\u8457\u65e5\u8a18(Logging)\uff0c\u6211\u5011\u53ef\u4ee5\u5c07\u4e0a\u4e00\u500b\u6aa2\u67e5\u9ede\u4e4b\u5f8c\u7684\u6240\u6709\u52d5\u4f5c\u5b58\u8d77\u4f86\uff0c\u5728\u7cfb\u7d71\u6545\u969c\u7684\u6642\u5019\uff0c\u5c07\u52d5\u4f5c\u61c9\u7528\u5728\u90a3\u500b\u6aa2\u67e5\u9ede\u4e0a\u9762\u3002\u64f4\u5c55\u9019\u4e9b\u6280\u8853\uff0c\u7528**\u4ea4\u6613(Transactional)**\u6a5f\u5236\u4f86\u57f7\u884c\u597d\u5e7e\u7d44\u52d5\u4f5c\u3002"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"\u5132\u5b58\u7684\u6642\u6a5f\uff1a"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u65b0\u589e\u5b8c\u547d\u4ee4\u5f0f"}),"\n",(0,o.jsx)(e.li,{children:"\u57f7\u884c\u5b8c\u547d\u4ee4\u5f0f"}),"\n",(0,o.jsx)(e.li,{children:"\u5fa9\u539f\u57f7\u884c\u904e\u7684\u547d\u4ee4\u5f8c"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"\u8f09\u5165\u7684\u6642\u6a5f\uff1a"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u7cfb\u7d71\u521d\u59cb\u5316\u6642(\u6aa2\u67e5\u662f\u5426\u6709\u672a\u57f7\u884c\u547d\u4ee4)"}),"\n",(0,o.jsx)(e.li,{children:"\u767c\u751f\u7570\u5e38\u6642"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.admonition,{type:"caution",children:(0,o.jsxs)(e.p,{children:["Store \u548c Load \u7684\u505a\u6cd5\u6bd4\u8f03\u5c11\u898b\uff0c\u56e0\u70ba\u547d\u4ee4\u9084\u8981\u8ca0\u8cac\u5132\u5b58\u8f09\u5165\uff0c\u6709\u9ede",(0,o.jsx)(e.strong,{children:"\u8e30\u8d8a\u8077\u8cac"}),"\u4e86"]})}),"\n",(0,o.jsx)(e.h3,{id:"\u6bd4\u8f03\u5e38\u898b\u7684\u505a\u6cd5\u662f\u4f7f\u7528\u4e00\u500b\u65b0\u7684\u4ecb\u9762",children:"\u6bd4\u8f03\u5e38\u898b\u7684\u505a\u6cd5\u662f\uff0c\u4f7f\u7528\u4e00\u500b\u65b0\u7684\u4ecb\u9762"}),"\n",(0,o.jsx)(e.p,{children:"\u5b9a\u7fa9\u5169\u500b\u57fa\u672c\u64cd\u4f5c\uff1a"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"writeFile(Store)"}),"\n",(0,o.jsx)(e.li,{children:"readFile(Load)"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public interface Logger {\r\n    void writeFile(String pathName, Object object);\r\n    Object readFile(String pathName);\r\n}\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u547c\u53eb\u8005 Invoker \u5728\u4e0a\u9762\u5132\u5b58\u548c\u8f09\u5165\u7684\u6642\u6a5f\u9ede\u4e0a\uff0c\u547c\u53eb\u5177\u9ad4\u7684 Logger \u65b9\u6cd5\u5c31\u53ef\u4ee5\u4e86\uff0c\u7576\u7136\u8981\u66ff\u63db\u5132\u5b58\u8207\u8f09\u5165\u7684\u65b9\u6cd5\u6216\u6f14\u7b97\u6cd5\uff0c\u53ea\u9700\u8981\u65b0\u589e\u4e00\u500b\u985e\u5225\u6642\u505a Logger \u4ecb\u9762\u3002"}),"\n",(0,o.jsxs)(e.p,{children:["Invoker \u4e0d\u7528\u77e5\u9053\u5177\u9ad4\u7684 Logger \u662f\u8ab0\uff0c\u53ea\u7ba1\u547c\u53eb\u65b9\u6cd5\uff0c\u9019\u4e5f\u662f",(0,o.jsx)(e.strong,{children:"\u7b56\u7565\u6a21\u5f0f"}),"\u7684\u7d50\u5408\u61c9\u7528\uff5e\uff01"]}),"\n",(0,o.jsx)(e.h3,{id:"\u5132\u5b58\u7684\u5be6\u73fe",children:"\u5132\u5b58\u7684\u5be6\u73fe"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u7269\u4ef6\u5e8f\u5217\u5316(Serialization)"}),"\n",(0,o.jsx)(e.li,{children:"\u8cc7\u6599\u5eab"}),"\n"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u4ee5\u7269\u4ef6\u5e8f\u5217\u5316\u8209\u4f8b"}),"\n"]}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u9996\u5148\u6211\u5011\u9700\u8981\u88ab\u5e8f\u5217\u5316\u7684\u7269\u4ef6\uff0c\u6642\u505a Serializable \u4ecb\u9762\uff0cCommand \u985e\u5225\u6642\u5e38\u4f7f\u7528\u62bd\u8c61\u985e\u5225"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:"public abstract class Command implements Cloneable, Serializable{\r\n    public abstract void execute();\r\n    public abstract void undo();\r\n\r\n    @Override\r\n    public Object clone() throws CloneNotSupportedException {\r\n        return super.clone();\r\n    }\r\n}\n"})}),"\n",(0,o.jsxs)(e.ol,{start:"2",children:["\n",(0,o.jsx)(e.li,{children:"\u64b0\u5beb\u5177\u9ad4\u7684 Logger \u985e\u5225"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class FileLogger implements Logger {\r\n    public void writeFile(String pathName, Object object) {\r\n        File file = new File(pathName);\r\n\r\n        try (FileOutputStream fs = new FileOutputStream(file);\r\n             BufferedOutputStream bs = new BufferedOutputStream(fs);\r\n             ObjectOutputStream os = new ObjectOutputStream(bs)\r\n        ) {\r\n\r\n            // if file doesn\'t exists, then create it\r\n\r\n            if (!file.exists()) {\r\n                file.createNewFile();\r\n            }\r\n\r\n            os.writeObject(object);\r\n\r\n            System.out.println("-----\u5beb\u5165\u83dc\u55ae\u65e5\u8a8c (Log)-----");\r\n\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    public Object readFile(String pathName) {\r\n\r\n        Object result = null;\r\n\r\n        File file = new File(pathName);\r\n\r\n        if (!file.exists()) {\r\n            return null;\r\n        }\r\n\r\n        try (FileInputStream fs = new FileInputStream(file);\r\n             BufferedInputStream bs = new BufferedInputStream(fs);\r\n             ObjectInputStream os = new ObjectInputStream(bs)) {\r\n\r\n            result = os.readObject();\r\n\r\n            System.out.println("-----\u8b80\u53d6\u83dc\u55ae\u65e5\u8a8c (Log)-----");\r\n\r\n        } catch (IOException | ClassNotFoundException e) {\r\n            e.printStackTrace();\r\n        }\r\n        return result;\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014-\u89c0\u5bdf\u8005\u6a21\u5f0f\u517c\u547d\u4ee4\u6a21\u5f0f",children:"\u547d\u4ee4\u6a21\u5f0f\u7684\u5176\u4ed6\u7528\u9014: \u89c0\u5bdf\u8005\u6a21\u5f0f\u517c\u547d\u4ee4\u6a21\u5f0f"}),"\n",(0,o.jsxs)(e.p,{children:["Java\u7684Swing\u7a0b\u5f0f\u5eab\u6709\u8a31\u591a",(0,o.jsx)(e.strong,{children:"ActionListener"}),"\u5f62\u5f0f\u7684",(0,o.jsx)(e.strong,{children:"Observer"}),"\u53ef\u4ee5\u76e3\u807d(\u6216\u89c0\u5bdf)\u4f7f\u7528\u8005\u4ecb\u9762\u5143\u4ef6\u7684\u4e8b\u4ef6\u3002"]}),"\n",(0,o.jsx)(e.p,{children:"\u4e8b\u5be6\u4e0aActionListener\u4e0d\u4f46\u662fObserver\u4ecb\u9762\uff0c\u4e5f\u662fCommand\u4ecb\u9762\uff0c\u800c\u4e14AngelListener\u3001DevilListener\u985e\u5225\u4e0d\u50c5\u662fObserver\uff0c\u4e5f\u662f\u5177\u9ad4\u7684Command\u3002"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'public class SwingCommandExample {\r\n    JFrame frame = new JFrame();\r\n    JPanel panel = new JPanel();\r\n\r\n    public static void main(String[] args) {\r\n        SwingCommandExample example = new SwingCommandExample();\r\n        example.go();\r\n    }\r\n\r\n    public void go() {\r\n        // The GUI is the client\r\n        // The buttons are the invokers\r\n        JButton onButton = new JButton("On");\r\n        JButton offButton = new JButton("Off");\r\n\r\n        // The light is the receiver\r\n        JLabel light = new JLabel("light");\r\n        light.setOpaque(true);\r\n        light.setBackground(Color.LIGHT_GRAY);\r\n\r\n        // The lambdas (ActionListeners) are the commands\r\n        // The interface that all the commands (listeners) implement is the ActionListener interface.\r\n        // This interface has one method, actionPerformed(). This is equivalent to the execute() method.\r\n        // This method which executes the code to run on the receiver, the light.\r\n        onButton.addActionListener(event ->\r\n            light.setBackground(Color.YELLOW)\r\n        );\r\n        offButton.addActionListener(event ->\r\n            light.setBackground(Color.LIGHT_GRAY)\r\n        );\r\n\r\n        // Set frame properties\r\n        frame.setContentPane(panel);\r\n        panel.add(onButton);\r\n        panel.add(light);\r\n        panel.add(offButton);\r\n\r\n        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n        frame.setSize(300,300);\r\n        frame.setVisible(true);\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62-\u5c01\u88dd\u63a5\u6536\u8005-encapsulate-receiver",children:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62: \u5c01\u88dd\u63a5\u6536\u8005 (Encapsulate Receiver)"}),"\n",(0,o.jsx)(e.p,{children:"\u5c01\u88dd\u6389 Receiver (\u9664\u975e\u771f\u6709\u5fc5\u8981\uff0c\u5982\u64a4\u92b7\u8655\u7406)\uff0c\u9ad8\u968e\u6a21\u7d44 Client\uff0c\u6e1b\u5c11\u4e86\u5c0d\u4f4e\u968e\u6a21\u7d44 Receiver \u7684\u4f9d\u8cf4\uff0c\u4e5f\u5c31\u4e0d\u518d\u9700\u8981\u9032\u884c \u5177\u9ad4\u547d\u4ee4 (ConcreteCommand) \u8207 \u63a5\u6536\u8005 (Receiver) \u7684\u7d44\u88dd\u3002"}),"\n",(0,o.jsxs)(e.p,{children:["Client \u7684\u8077\u8cac\u8f49\u8b8a\u70ba\u7d14\u7cb9\u7684\uff1a\u7d66\u4e88 \u547c\u53eb\u8005 (Invoker) \u5177\u9ad4\u7684\u547d\u4ee4 (ConcreteCommand) \u800c",(0,o.jsx)(e.strong,{children:"\u4e0d\u9700\u9032\u884c \u63a5\u6536\u8005 (Receiver) \u7d44\u88dd"})]}),"\n",(0,o.jsx)(e.admonition,{type:"danger",children:(0,o.jsx)(e.p,{children:"\u500b\u4eba\u4e26\u4e0d\u559c\u6b61"})}),"\n",(0,o.jsx)(e.h3,{id:"\u5931\u6557\u7684\u8a2d\u8a08",children:"\u5931\u6557\u7684\u8a2d\u8a08"}),"\n",(0,o.jsx)(e.p,{children:"\u6700\u5e38\u898b\u5230\u7684\u5c31\u662f\uff1a"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\u63a5\u6536\u8005 (Receiver) \u8207 \u5177\u9ad4\u547d\u4ee4 (ConcreteCommand) \u7684\u8026\u5408"}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"\u4f8b\u5982\uff1a"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:"\u7701\u53bb Client \u70ba ConcreteCommand \u8a2d\u7f6e Receiver \u7684\u52d5\u4f5c"}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"\u51fa\u767c\u9ede\u662f\u597d\u7684\uff0c\u4f46\u8a31\u591a\u4eba\u7684\u505a\u6cd5\u537b\u662f\uff1a"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u5c07 ConcreteCommand \u76f4\u63a5\u50b3\u905e\u7d66 Receiver"}),"\n",(0,o.jsx)(e.li,{children:"\u900f\u904e setReceiver(this); \u7684\u65b9\u5f0f\u7d44\u88dd"}),"\n",(0,o.jsx)(e.li,{children:"Receiver \u518d\u53bb\u57f7\u884c\u547d\u4ee4 ..."}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"\u9019\u6703\u4f7f\u7684"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"Receiver \u9664\u4e86\u5f97\u64b0\u5beb\u696d\u52d9\u908f\u8f2f\uff0c\u9084\u8981\u53bb\u8003\u616e\u5230 Command \u7684\u72c0\u614b"}),"\n",(0,o.jsx)(e.li,{children:"Invoker \u8077\u8cac\u662f \u8981\u6c42 Command \u57f7\u884c\u547d\u4ee4\uff0c\u4f60\u73fe\u5728\u4e1f\u7d66 Receiver \u505a\uff0cInvoker \u7121\u4e8b\u53ef\u505a"}),"\n",(0,o.jsx)(e.li,{children:"\u547d\u4ee4\u6a21\u5f0f\u7684\u6700\u5927\u597d\u8655: \u300c\u5c07\u300e\u5f15\u767c\u547d\u4ee4\u7684\u7269\u4ef6\u300f\u8207\u300e\u5be6\u969b\u57f7\u884c\u64cd\u4f5c\u7684\u7269\u4ef6\u300f\u9694\u96e2\u958b\u4f86\u300d\uff0c\u9019\u4e0b\u597d\u4e86\uff0cReceiver \u540c\u6642\u4ee3\u8868\u5169\u8005\uff0c\u4f60\u9084\u7528\u9019\u500b\u6a21\u5f0f\u5e79\u561b\uff1f"}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62-\u5ba2\u6236\u7aef--\u8077\u8cac\u5206\u96e2-client--segregation-of-duties",children:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62: \u5ba2\u6236\u7aef \u2014 \u8077\u8cac\u5206\u96e2 (Client \u2014 Segregation of Duties)"}),"\n",(0,o.jsxs)(e.p,{children:["\u5176\u76ee\u7684\u8207 \u300e\u5c01\u88dd\u547c\u53eb\u8005 (Encapsulate Receiver)\u300f \u4e00\u6a21\u4e00\u6a23\uff0cClient \u7684\u8077\u8cac\u8f49\u8b8a\u70ba\u7d14\u7cb9\u7684\uff1a\u7d66\u4e88 \u547c\u53eb\u8005 (Invoker) \u5177\u9ad4\u7684\u547d\u4ee4 (ConcreteCommand) \u800c",(0,o.jsx)(e.strong,{children:"\u4e0d\u9700\u9032\u884c \u63a5\u6536\u8005 (Receiver) \u7d44\u88dd"})]}),"\n",(0,o.jsx)(e.admonition,{type:"info",children:(0,o.jsx)(e.p,{children:"\u500b\u4eba\u8f03\u559c\u6b61"})}),"\n",(0,o.jsx)(e.p,{children:"\u53bb\u9664 Client \u7d44\u88dd \u63a5\u6536\u8005 (Receiver) \u7684\u8077\u8cac\uff0c\u4ea4\u7d66\u65b0\u7684\u985e\u5225\u300eRemoteLoader\u300f\u4f86\u7d44\u88dd\u3002Client\u6e96\u5099\u597d\u547d\u4ee4(ConcreteCommand)\u518d\u50b3\u905e\u7d66\u9059\u63a7\u5668(Invoker)\u5373\u53ef\u3002"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'// client\r\nRemoteLoader remoteLoader = new RemoteLoader("remote");\r\nremoteLoader.getRemoteControl();\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62-\u667a\u6167\u547d\u4ee4",children:"\u547d\u4ee4\u6a21\u5f0f\u8b8a\u5f62: \u667a\u6167\u547d\u4ee4"}),"\n",(0,o.jsx)(e.p,{children:"\u547d\u4ee4 (Command) \u4e0d\u518d\u9700\u8981 \u63a5\u6536\u8005 (Receiver)\uff0c\u81ea\u5df1\u5c31\u77e5\u9053\u600e\u9ebc\u5be6\u73fe\u529f\u80fd\u3002"}),"\n",(0,o.jsx)(e.admonition,{type:"info",children:(0,o.jsx)(e.p,{children:"\u500b\u4eba\u8f03\u559c\u6b61"})})]})}function c(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(m,{...n})}):m(n)}},7962:(n,e,r)=>{r.d(e,{A:()=>o});const o=r.p+"assets/images/ThreadPoolExecutor-c818dfceb20eabbbf022006005b86987.png"},6973:(n,e,r)=>{r.d(e,{A:()=>o});const o=r.p+"assets/images/\u547d\u4ee4\u6a21\u5f0f\u67b6\u69cb-a70960fda303fe61537cea69c1e632f8.png"},1774:(n,e,r)=>{r.d(e,{A:()=>o});const o=r.p+"assets/images/\u5b8c\u6210\u7684\u63a7\u5236\u5668-cae210406e478d6544b7359a748fb122.png"},8870:(n,e,r)=>{r.d(e,{A:()=>o});const o=r.p+"assets/images/\u5ee0\u5546\u7684\u985e\u5225-b315b7001a00e52d03be10402b674e49.png"},2870:(n,e,r)=>{r.d(e,{A:()=>o});const o=r.p+"assets/images/\u63a7\u5236\u5668-2778e1635ba7289da5f73bb8cc8f3c3f.png"},1126:(n,e,r)=>{r.d(e,{A:()=>o});const o=r.p+"assets/images/\u9059\u63a7\u5668\u8a2d\u8a08API-3c49e57c7dfd58fbb4c8c9532e67af2a.png"},8453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>a});var o=r(6540);const i={},t=o.createContext(i);function l(n){const e=o.useContext(t);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),o.createElement(t.Provider,{value:e},n.children)}}}]);