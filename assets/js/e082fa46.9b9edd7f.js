"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[8675],{28453:(n,e,s)=>{s.d(e,{R:()=>l,x:()=>o});var r=s(96540);const t={},i=r.createContext(t);function l(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),r.createElement(i.Provider,{value:e},n.children)}},84850:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>o,default:()=>a,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"notes/owasp-top10-2021/security-logging-and-monitoring-failures","title":"A09: \u5b89\u5168\u8a18\u9304\u8207\u76e3\u63a7\u5931\u6557\uff08Security Logging and Monitoring Failures\uff09","description":"\u6f0f\u6d1e\u6982\u8ff0","source":"@site/docs/notes/owasp-top10-2021/14-security-logging-and-monitoring-failures.mdx","sourceDirName":"notes/owasp-top10-2021","slug":"/notes/owasp-top10-2021/security-logging-and-monitoring-failures","permalink":"/docs/notes/owasp-top10-2021/security-logging-and-monitoring-failures","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":14,"frontMatter":{},"sidebar":"notesSidebar","previous":{"title":"A08: \u8edf\u9ad4\u8207\u8cc7\u6599\u5b8c\u6574\u6027\u5931\u6557\uff08Software and Data Integrity Failures\uff09","permalink":"/docs/notes/owasp-top10-2021/software-and-data-integrity-failures"}}');var t=s(74848),i=s(28453);const l={},o="A09: \u5b89\u5168\u8a18\u9304\u8207\u76e3\u63a7\u5931\u6557\uff08Security Logging and Monitoring Failures\uff09",d={},c=[{value:"\u6f0f\u6d1e\u6982\u8ff0",id:"\u6f0f\u6d1e\u6982\u8ff0",level:2},{value:"\ud83d\udd0d \u554f\u984c\u5206\u6790",id:"-\u554f\u984c\u5206\u6790",level:2},{value:"1. \u7f3a\u4e4f\u767b\u5165\u8207\u6b0a\u9650\u7570\u5e38\u76e3\u63a7",id:"1-\u7f3a\u4e4f\u767b\u5165\u8207\u6b0a\u9650\u7570\u5e38\u76e3\u63a7",level:3},{value:"2. \u65e5\u8a8c\u683c\u5f0f\u6df7\u4e82\uff0c\u7121\u6cd5\u5206\u6790\u653b\u64ca\u884c\u70ba",id:"2-\u65e5\u8a8c\u683c\u5f0f\u6df7\u4e82\u7121\u6cd5\u5206\u6790\u653b\u64ca\u884c\u70ba",level:3},{value:"3. \u672a\u5373\u6642\u76e3\u63a7\uff0c\u5c0e\u81f4\u653b\u64ca\u9577\u6642\u9593\u672a\u88ab\u767c\u73fe",id:"3-\u672a\u5373\u6642\u76e3\u63a7\u5c0e\u81f4\u653b\u64ca\u9577\u6642\u9593\u672a\u88ab\u767c\u73fe",level:3}];function h(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"a09-\u5b89\u5168\u8a18\u9304\u8207\u76e3\u63a7\u5931\u6557security-logging-and-monitoring-failures",children:"A09: \u5b89\u5168\u8a18\u9304\u8207\u76e3\u63a7\u5931\u6557\uff08Security Logging and Monitoring Failures\uff09"})}),"\n",(0,t.jsx)(e.h2,{id:"\u6f0f\u6d1e\u6982\u8ff0",children:"\u6f0f\u6d1e\u6982\u8ff0"}),"\n",(0,t.jsxs)(e.p,{children:["\u7576\u7cfb\u7d71\u7f3a\u4e4f",(0,t.jsx)(e.strong,{children:"\u9069\u7576\u7684\u65e5\u8a8c\u8a18\u9304"}),"\u6216",(0,t.jsx)(e.strong,{children:"\u5b89\u5168\u76e3\u63a7"}),"\u6642\uff0c\u653b\u64ca\u8005\u53ef\u4ee5\u5728\u7cfb\u7d71\u5167\u90e8\u9032\u884c\u60e1\u610f\u884c\u70ba\uff0c\u800c\u7ba1\u7406\u8005\u537b\u6beb\u7121\u5bdf\u89ba\u3002\u4f8b\u5982\uff1a"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u672a\u8a18\u9304\u7570\u5e38\u884c\u70ba"}),"\uff08\u5982\u591a\u6b21\u767b\u5165\u5931\u6557\u3001\u6b0a\u9650\u63d0\u5347\u3001SQL \u6ce8\u5165\u7b49\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u65e5\u8a8c\u672a\u53ca\u6642\u76e3\u63a7"}),"\uff08\u7121\u6cd5\u5373\u6642\u767c\u73fe\u653b\u64ca\u6d3b\u52d5\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u65e5\u8a8c\u683c\u5f0f\u6df7\u4e82\u6216\u7f3a\u4e4f\u5fc5\u8981\u8cc7\u8a0a"}),"\uff08\u7121\u6cd5\u8ffd\u8e64\u653b\u64ca\u4f86\u6e90\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u65e5\u8a8c\u5b58\u53d6\u6b0a\u9650\u4e0d\u7576"}),"\uff08\u653b\u64ca\u8005\u53ef\u522a\u9664\u6216\u4fee\u6539\u65e5\u8a8c\uff09"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u9019\u4e9b\u554f\u984c\u53ef\u80fd\u5c0e\u81f4\u653b\u64ca\u767c\u751f\u5f8c\u7121\u6cd5\u8ffd\u8e64\u653b\u64ca\u8005\uff0c\u751a\u81f3\u5f71\u97ff\u6cd5\u898f\u9075\u5f9e\uff08\u5982 ",(0,t.jsx)(e.strong,{children:"GDPR\u3001ISO 27001\u3001PCI-DSS"}),"\uff09\u3002"]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"-\u554f\u984c\u5206\u6790",children:"\ud83d\udd0d \u554f\u984c\u5206\u6790"}),"\n",(0,t.jsx)(e.h3,{id:"1-\u7f3a\u4e4f\u767b\u5165\u8207\u6b0a\u9650\u7570\u5e38\u76e3\u63a7",children:"1. \u7f3a\u4e4f\u767b\u5165\u8207\u6b0a\u9650\u7570\u5e38\u76e3\u63a7"}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u61c9\u7528\u7a0b\u5f0f\u672a\u8a18\u9304\u767b\u5165\u5617\u8a66\u3001\u5e33\u865f\u9396\u5b9a\u7b49\u884c\u70ba\uff0c\u653b\u64ca\u8005\u53ef\u4ee5\u66b4\u529b\u7834\u89e3\u5e33\u865f\uff0c\u751a\u81f3\u63d0\u5347\u6b0a\u9650\uff0c\u7cfb\u7d71\u537b\u6beb\u7121\u8b66\u89ba\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"\u653b\u64ca\u65b9\u5f0f"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u653b\u64ca\u8005\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u5de5\u5177\uff08\u5982 Hydra\uff09\u5617\u8a66\u767b\u5165\u5927\u91cf\u5e33\u865f"}),"\n",(0,t.jsxs)(e.li,{children:["\u60e1\u610f\u4f7f\u7528\u8005\u5617\u8a66 ",(0,t.jsx)(e.strong,{children:"\u6b0a\u9650\u63d0\u5347"}),"\uff08\u5982\u4f4e\u6b0a\u9650\u5e33\u865f\u5617\u8a66\u5b58\u53d6\u7ba1\u7406\u54e1\u4ecb\u9762\uff09"]}),"\n",(0,t.jsx)(e.li,{children:"\u591a\u6b21\u5931\u6557\u767b\u5165\u5f8c\u4ecd\u672a\u9396\u5b9a\u5e33\u865f\uff0c\u5141\u8a31\u6301\u7e8c\u653b\u64ca"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"\u793a\u7bc4\u7a0b\u5f0f\u78bc\uff08Golang\uff1a\u672a\u8a18\u9304\u767b\u5165\u5617\u8a66\uff09"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n\t"fmt"\n\t"net/http"\n)\n\nfunc loginHandler(w http.ResponseWriter, r *http.Request) {\n\tusername := r.FormValue("username")\n\tpassword := r.FormValue("password")\n\n\t// \u9019\u88e1\u7f3a\u4e4f\u767b\u5165\u65e5\u8a8c\u8a18\u9304\n\tif username == "admin" && password == "123456" {\n\t\tfmt.Fprintf(w, "\u767b\u5165\u6210\u529f")\n\t} else {\n\t\tfmt.Fprintf(w, "\u767b\u5165\u5931\u6557")\n\t}\n}\n\nfunc main() {\n\thttp.HandleFunc("/login", loginHandler)\n\thttp.ListenAndServe(":8080", nil)\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"\u554f\u984c"}),"\uff1a"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u9019\u6bb5\u7a0b\u5f0f\u78bc",(0,t.jsx)(e.strong,{children:"\u672a\u8a18\u9304\u767b\u5165\u6210\u529f\u6216\u5931\u6557\u7684\u8cc7\u8a0a"}),"\uff0c\u7ba1\u7406\u8005\u7121\u6cd5\u8ffd\u8e64\u7570\u5e38\u767b\u5165\u884c\u70ba\u3002"]}),"\n",(0,t.jsxs)(e.li,{children:["\u82e5\u4f7f\u7528\u8005\u591a\u6b21\u8f38\u5165\u932f\u8aa4\u5bc6\u78bc\uff0c\u61c9\u7528\u7a0b\u5f0f",(0,t.jsx)(e.strong,{children:"\u672a\u9396\u5b9a\u5e33\u865f"}),"\uff0c\u5141\u8a31\u66b4\u529b\u7834\u89e3\u653b\u64ca\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u2705 ",(0,t.jsx)(e.strong,{children:"\u4fee\u88dc\u63aa\u65bd"})]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u8a18\u9304\u6240\u6709\u767b\u5165\u6210\u529f\u8207\u5931\u6557\u7684\u65e5\u8a8c"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u555f\u7528\u591a\u56e0\u7d20\u9a57\u8b49\uff08MFA\uff09\u4f86\u589e\u52a0\u5b89\u5168\u6027"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u8a2d\u7f6e\u767b\u5165\u5931\u6557\u6b21\u6578\u9650\u5236\uff0c\u4e26\u8a18\u9304\u7570\u5e38\u767b\u5165\u884c\u70ba"})}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\ud83d\udee0\ufe0f ",(0,t.jsx)(e.strong,{children:"\u4fee\u6b63\u5f8c\uff08\u8a18\u9304\u767b\u5165\u65e5\u8a8c + \u5e33\u865f\u9396\u5b9a\uff09"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n\t"fmt"\n\t"log"\n\t"net/http"\n\t"sync"\n\t"time"\n)\n\n// \u8ffd\u8e64\u5931\u6557\u767b\u5165\u6b21\u6578\nvar failedLogins = make(map[string]int)\nvar lock = sync.Mutex{}\n\nfunc loginHandler(w http.ResponseWriter, r *http.Request) {\n\tusername := r.FormValue("username")\n\tpassword := r.FormValue("password")\n\n\tlock.Lock()\n\tdefer lock.Unlock()\n\n\t// \u5982\u679c\u5e33\u865f\u5df2\u9396\u5b9a\n\tif failedLogins[username] >= 3 {\n\t\tlog.Printf("\u5e33\u865f %s \u5df2\u9396\u5b9a\uff0c\u767b\u5165\u5931\u6557", username)\n\t\thttp.Error(w, "\u5e33\u865f\u5df2\u9396\u5b9a", http.StatusForbidden)\n\t\treturn\n\t}\n\n\tif username == "admin" && password == "securepassword" {\n\t\tlog.Printf("\u4f7f\u7528\u8005 %s \u767b\u5165\u6210\u529f", username)\n\t\tfmt.Fprintf(w, "\u767b\u5165\u6210\u529f")\n\t\tdelete(failedLogins, username) // \u6e05\u9664\u5931\u6557\u8a18\u9304\n\t} else {\n\t\tlog.Printf("\u4f7f\u7528\u8005 %s \u767b\u5165\u5931\u6557", username)\n\t\tfailedLogins[username]++\n\t\ttime.AfterFunc(5*time.Minute, func() { // 5 \u5206\u9418\u5f8c\u91cd\u7f6e\n\t\t\tlock.Lock()\n\t\t\tdelete(failedLogins, username)\n\t\t\tlock.Unlock()\n\t\t})\n\t\thttp.Error(w, "\u767b\u5165\u5931\u6557", http.StatusUnauthorized)\n\t}\n}\n\nfunc main() {\n\thttp.HandleFunc("/login", loginHandler)\n\tlog.Println("\u4f3a\u670d\u5668\u555f\u52d5\u65bc :8080")\n\thttp.ListenAndServe(":8080", nil)\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\ud83d\udee0\ufe0f ",(0,t.jsx)(e.strong,{children:"\u4fee\u6b63\u9ede"}),"\uff1a"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u8a18\u9304\u767b\u5165\u884c\u70ba"}),"\uff08\u6210\u529f\u8207\u5931\u6557\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u52a0\u5165\u5e33\u865f\u9396\u5b9a\u6a5f\u5236"}),"\uff08\u9632\u6b62\u66b4\u529b\u7834\u89e3\uff09"]}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u9650\u5236\u767b\u5165\u5931\u6557\u6b21\u6578\u4e26\u8a2d\u7f6e\u89e3\u9396\u6642\u9593"})}),"\n"]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h3,{id:"2-\u65e5\u8a8c\u683c\u5f0f\u6df7\u4e82\u7121\u6cd5\u5206\u6790\u653b\u64ca\u884c\u70ba",children:"2. \u65e5\u8a8c\u683c\u5f0f\u6df7\u4e82\uff0c\u7121\u6cd5\u5206\u6790\u653b\u64ca\u884c\u70ba"}),"\n",(0,t.jsxs)(e.p,{children:["\u82e5\u65e5\u8a8c\u683c\u5f0f\u4e0d\u7d71\u4e00\uff0c\u6216\u8005",(0,t.jsx)(e.strong,{children:"\u7f3a\u5c11\u95dc\u9375\u8cc7\u8a0a"}),"\uff08\u5982 IP\u3001\u6642\u9593\u6233\u8a18\u3001\u7528\u6236 ID\uff09\uff0c\u5247\u96e3\u4ee5\u9032\u884c\u5b89\u5168\u5206\u6790\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"\u653b\u64ca\u65b9\u5f0f"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u653b\u64ca\u8005\u767b\u9304\u60e1\u610f\u5e33\u865f\uff0c\u7cfb\u7d71\u8a18\u9304\u4e0d\u5168\uff0c\u96e3\u4ee5\u8ffd\u8e64\u4f86\u6e90"}),"\n",(0,t.jsx)(e.li,{children:"SQL \u6ce8\u5165\u653b\u64ca\u5f8c\uff0c\u65e5\u8a8c\u672a\u986f\u793a\u653b\u64ca\u8f09\u8377\uff0c\u7121\u6cd5\u5fa9\u73fe\u653b\u64ca\u624b\u6cd5"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"\u793a\u7bc4\u7a0b\u5f0f\u78bc\uff08\u4e0d\u5b8c\u6574\u7684\u65e5\u8a8c\uff09"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'log.Println("\u767b\u5165\u5931\u6557")\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"\u554f\u984c"}),"\uff1a"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u6c92\u6709\u8a18\u9304 ",(0,t.jsx)(e.strong,{children:"IP\u3001\u6642\u9593\u3001\u5e33\u865f\u3001\u5617\u8a66\u7684\u5bc6\u78bc"}),"\uff0c\u65e5\u5f8c\u96e3\u4ee5\u8abf\u67e5"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u2705 ",(0,t.jsx)(e.strong,{children:"\u4fee\u88dc\u63aa\u65bd"})]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u7d71\u4e00\u65e5\u8a8c\u683c\u5f0f\uff0c\u8a18\u9304\u5fc5\u8981\u8cc7\u8a0a\uff08IP\u3001\u6642\u9593\u3001\u4f7f\u7528\u8005 ID\uff09"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u5c07\u65e5\u8a8c\u5b58\u5165 ELK\u3001Splunk \u6216 SIEM \u5e73\u53f0"})}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\ud83d\udee0\ufe0f ",(0,t.jsx)(e.strong,{children:"\u4fee\u6b63\u5f8c"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'log.Printf("[Login Failed] Time: %s | IP: %s | User: %s", time.Now().Format(time.RFC3339), r.RemoteAddr, username)\n'})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h3,{id:"3-\u672a\u5373\u6642\u76e3\u63a7\u5c0e\u81f4\u653b\u64ca\u9577\u6642\u9593\u672a\u88ab\u767c\u73fe",children:"3. \u672a\u5373\u6642\u76e3\u63a7\uff0c\u5c0e\u81f4\u653b\u64ca\u9577\u6642\u9593\u672a\u88ab\u767c\u73fe"}),"\n",(0,t.jsxs)(e.p,{children:["\u5982\u679c\u61c9\u7528\u7a0b\u5f0f\u53ea\u8a18\u9304\u65e5\u8a8c\uff0c\u4f46\u6c92\u6709",(0,t.jsx)(e.strong,{children:"\u5373\u6642\u76e3\u63a7"}),"\uff0c\u653b\u64ca\u8005\u53ef\u4ee5\u9577\u6642\u9593\u5728\u7cfb\u7d71\u5167\u90e8\u6d3b\u52d5\u800c\u4e0d\u88ab\u767c\u73fe\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:["\u274c ",(0,t.jsx)(e.strong,{children:"\u653b\u64ca\u65b9\u5f0f"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u653b\u64ca\u8005\u9577\u671f\u4f7f\u7528 SQL \u6ce8\u5165\u7aca\u53d6\u8cc7\u6599\uff0c\u7ba1\u7406\u8005\u537b\u672a\u5bdf\u89ba"}),"\n",(0,t.jsx)(e.li,{children:"\u7cfb\u7d71\u88ab\u690d\u5165\u5f8c\u9580\uff08Web Shell\uff09\uff0c\u4f46\u6c92\u6709\u8b66\u5831\u901a\u77e5"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u2705 ",(0,t.jsx)(e.strong,{children:"\u4fee\u88dc\u63aa\u65bd"})]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u4f7f\u7528 SIEM \u76e3\u63a7\u65e5\u8a8c\uff0c\u8a2d\u5b9a\u7570\u5e38\u884c\u70ba\u8b66\u5831"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u5c0d\u654f\u611f\u64cd\u4f5c\uff08\u5982\u8cc7\u6599\u522a\u9664\u3001\u6b0a\u9650\u63d0\u5347\uff09\u8a2d\u7f6e\u5373\u6642\u8b66\u5831"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.strong,{children:"\u8a18\u9304 API \u5b58\u53d6\u884c\u70ba\uff0c\u5075\u6e2c\u7570\u5e38\u8acb\u6c42"})}),"\n"]})]})}function a(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(h,{...n})}):h(n)}}}]);